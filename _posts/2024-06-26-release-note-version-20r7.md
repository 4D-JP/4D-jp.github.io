---
layout: fix
title: "4D 20r7 修正リスト"
date: 2024-11-13 08:00:00
categories: 修正リスト
tags: 20r7
build: 100167
version: "20r7"
permalink: /2024/274/:slug/
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}} 

* ACI0105204 ラジオボタンまたはチェックボックスに日本語`1`文字だけのタイトルが設定されている場合，正しく文字が表示されませんでした。

* ACI0105189 Write Proドキュメントのヘッダーに表を挿入し，その表に対して`WP Get position`を実行した場合，アプリケーションがクラッシュしました。

* ACI0105183 Macクライアント/サーバー版のみ。サーバーがフリーズすることがありました。コオペラティブプロセスのスケジューラーがデッドロックに陥る条件があるようです。

* ACI0105175 複数の段落が選択された状態でWrite Proエリアに対して`Get action info`を実行した場合，`status`に`"mixed"`が返されませんでした。また，マージン情報は選択の冒頭にある段落のものが返されました。

**注記**: 問題は修正されましたが，パフォーマンス最適化のため，指定されたレンジの冒頭`2000`文字に基づいて`"mixed"`かどうかが判定されます。それよりもおおきなレンジの場合，正しい`status`が返されないかもしれません。

* ACI0105174 フォームに複数のWrite Pro標準アクションオブジェクトが存在する場合， `Get action info`から返されるWrite Proエリアの標準アクション情報が正しく更新されないことがありました。

* ACI0104919 スタートアップ直後のアクティビティが診断ログに記録されないことがありました。

**注記**: ロガーには`1000`項目分のフレームバッファが設定されています。短時間に`1000`以上のアクティビティログを出力した場合，もっとも古いアクティビティは記録されないかもしれません。4D 20は，4D 19よりも動作が速いため，この上限に達する可能性が高くなりました。修正に伴い，この上限値が見直されました。

* ACI0105136 Windows版のみ。プロジェクトを開いたことがない状態で環境設定にアクセスした場合，POSIXパスが無効であるというエラーが返されました。20r7ではクラッシュするかもしれません。

* ACI0105084 `POP3 Transporter`でメール受信に失敗した場合，メモリーリークが発生しました。接続オブジェクトとそのバッファが解放されていないためです。他のトランスポーターでも問題が再現します。

* ACI0105210 フランス語版のみ。アプリケーションビルド画面の「コード署名」の説明文が正しくありませんでした。正しいフランス語は*le processus requière* ではなく*le processus requiert* です。

* ACI0104992 `QR REPORT`の画面にストラクチャとバーチャルストラクチャの表示名が混在していました。

* ACI0105176 Write Proエリアの編集中に違うヘッダーの同じ相対位置にカーソルを移動してテキストを挿入した場合，*On Selection Change* イベントが発生しませんでした。

* ACI0104443 セレクション型リストボックスセルの*On Before Keystroke* イベントで`FILTER KEYSTROKE("")`を実行した場合，セルの内容が消去されました。

* ACI0105179 トランザクション中に更新されたエンティティがメモリから解放されるタイミングでアプリケーションがクラッシュすることがありました。

* ACI0105031 Write Proエリアのサイドウィジェットで`method4D:myAlert?parameter='Hello%20World!'`のようなメソッドのハイパーリンクを設定することができませんでした。

* ACI0105192 バイナリモードのみ。リストボックスの日付型カラムまたはフッターに表示フォーマットを設定した場合，日付の代わりに"todoicu"という文字列が表示されました。プロパティリストではなく`OBJECT SET FORMAT`を使用すれば問題ありません。

**注記**: 問題は修正されましたが，すでに"todoicu"という文字列がプロパティリストに登録されている場合，表示フォーマットを設定しなおす必要があります。

* ACI0105184 空のテーブルに対してLooker REST APIでアクセスした場合，リレーション属性の名前ではなく，そのテーブルの名前がスキーマとして返されました。

* ACI0105171 Windows版のみ。`0`°以外の向きに設定されたスタティックテキストに対して`OBJECT SET HORIZONTAL ALIGNMENT`を使用した場合，水平揃えを変更できませんでした。

* ACI0105064 SOAPサーバーがXML External Entity (XXE) 攻撃の標的になる可能性がありました。

* ACI0104985 *Excel* などのOfficeデスクトップアプリケーションから*Power Query* でSQLを実行した場合，`5`桁を超える数値が正しく返されませんでした。*MS Query* であれば問題ありません。

* ACI0104819 *Qodly Studio* のみ。新規プロジェクトを作成した場合，*Shared* フォルダーが自動的に作成されないため，コンポーネントをアップロードすることができませんでした。

* ACI0105125 `3`個以上のカラムに跨る段落が存在し，サブセクションのカラム数がそれぞれ違う場合，Write Proドキュメントのレイアウトが正しくありませんでした。

* ACI0105065 コレクション/エンティティセレクション型リストボックスの「自動行高」および「セレクションハイライトを非表示」を有効にした場合，リストを下方向にスクロールした後，行をクリックすると，上方向にリストがスクロールしました。配列型リストボックスでは問題ありません。

* ACI0105022 UUIDフィールドに対し，空の文字列を含むコレクションを使用してORDAクエリを実行した場合，間違った結果が返されました。

* ACI0105167 ラジオボタンまたはチェックボックスのタイトルが`1`文字の場合，タイトルの前にコロン記号（`:`）が追加されました。

* ACI0105163 抑制できるコンパイラー警告のリストに抑制できないエラーの番号も含まれていました。

* ACI0105161 ツールボックスの「ユーザー＆グループ」ページでグループ名をダブルクリックしてから項目を更新した場合，変更が反映されませんでした。コンテキストメニューを使用すれば問題ありません。

* ACI0105158 空のテーブルに対してLooker REST APIでアクセスした場合，スキーマが返されませんでした。

* ACI0105068 Qodly Studioのみ。データモデルクラスのメンバー関数とは違い，シングルトンのメンバー関数は`filePath` `startingLine` `endingLine`などのメタ情報がサーバーから返されませんでした。

* ACI0105157 Looker REST API（`$format=looker`）とドット記法でオブジェクト・BLOB・ピクチャ型のリレーション属性にアクセスした場合，エラー`400`ではなく`[]`が返されました。

* ACI0105105 パラメーターのない`exposed`属性のシングルトン関数にREST APIでアクセスした場合，エラーが返されました。明示的に空のリスト`[“”]`をHTTPリクエストで送信すれば問題ありません。

* ACI0105172 Mac版のみ。WindowsのプロジェクトフォルダーをSMBまたはCIFSで共有し，Macから開発モードを有効にして開こうとした場合，アプリケーションがクラッシュしました。プロジェクトフォルダー自体ではなく，その親フォルダーを共有すれば問題ありません。

* ACI0103752 4D ViewスプレッドシートをView Proに変換した場合，パーセンテージのフォーマットが正しく適用されませんでした。

* ACI0105100 リレーション属性が関係するORDAクエリが間違っていることがありました。ACI0104799が修正されたことによる副作用のようです。

```4d
ds.One.all().drop()
ds.Many.all().drop()
$One:=ds.One.new()
$One.Id:=1
$One.save()
$Many:=ds.Many.new()
$Many.Id:=1
$Many.OneId:=1
$Many.save()
$Query:="One.Id#0 & ((Id#0 & (Id=0 | One.Id=0)) | (Id#0 & (Id=0 | One.Id=0)))"
ALERT($Query+"\r\rExpected: 0\rResult: "+String(ds.Many.query($Query).length))
```

* ACI0105132 特定のドキュメントをWrite Proの埋め込みモードに表示することができませんでした。埋め込みモードでは，水平スクロールが常に表示され，自動改行モードがオフになることが関係しています。

* ACI0105074 フォルダー名に日本語やウムラウト記号のような拡張文字が含まれているWindowsの共有フォルダー（サブフォルダーではない）をSMBでMacでマウントした場合，エラーになりました。Windows同士，あるいはMacからWindowsの共有であれば問題ありません。ACI0104219が修正されたことによる副作用のようです。

* ACI0105061 `300,000`件以上のレコードがすでに登録されているフィールドの「ヌル値を空値にマップ」プロパティを有効に変更して，`QUERY WITH ARRAY`または`QUERY SELECTION WITH ARRAY`でシーケンシャルクエリを実行した場合，正しい結果よりも`1`件レコードが少ないセレクションが作成されました。

* ACI0105153 Mac版のみ。パレットタイプのウィンドウ（*Controller form window* *Pop up form window* *Toolbar form window* *Palette form window*）をフォーカスした場合，フォーカスされていないウィンドウのデフォルトボタンのタイトルがボタンと同色になりました。ダークモードでは問題ありません。

* ACI0105027 フォームエディターのコンテキストメニューで「同じ種類のオブジェクトを選択」した場合，ツールバーの整列/均等配置ボタンがアクティブ化されませんでした。

* ACI0105143 バイナリモードのみ。20r6以降，フォームに配置したピクチャの表示フォーマットが*Scaled to fit prop centered (6)* から*Truncated non centered (1)* に変わってしまうことがありました。

**注記**: ピクチャの表示フォーマットは文字列の表示フォーマットと同じように指定しますが，フォームオブジェクトのタイプを途中で変更した場合，ピクチャには適用できないはずの値が残されている可能性がありました。修正により，表示フォーマットの値だけでなく，オブジェクトのタイプもチェックされるようになりました。

* ACI0105126 アプリケーションまたはコンポーネントをビルドした場合，*.4DZ* ファイルの中に*dependencies.json* ファイルが含まれていました。

**注記**: `BUILD APPLICATION`が修正されました。もっとも*.4DZ* ファイルの中に*dependencies.json* ファイルが含まれていたとしても動作に影響はありません。

* ACI0105140 Windows版のみ。Windows 24H2で印刷コマンドを実行してPDFを出力しようとした場合，`OPEN PRINTING JOB`からエラーが返されることがありました。

* ACI0105142 メソッドエディターのオートコンプリートが原因でアプリケーションがクラッシュすることがありました。バックスペースキーで`var`構文で宣言した変数に代入する初期値のローカル変数を削除した後，再び`$`記号を入力したタイミングで発生します。

* ACI0105119 バイナリモードのみ。エクスプローラーのごみ箱をクリックせず，マウスオーバーした状態でコンテキストメニューを表示した場合，「ごみ箱に移動する」ではなく「ごみ箱を空にする」というメニューが表示されました。

* ACI0105072 ネットワークに接続していない環境でライセンスのアクティベーションを試みた場合，エラーメッセージが英語で表示されました。

* ACI0105128 *OAuth2* トークンと`SMTPTransporter`で*Gmail* を送信した場合，受信者のメッセージにBccヘッダーが表示されました。ACI0104608が修正されたことによる副作用です。

**注記**: 本来，Bccヘッダーはメールサーバーが除去するべきですが，すべてのメールサーバーがそのように設計されているわけではないようです。修正により，JMAPメッセージオブジェクトから変換されたMIMEにはBccヘッダーが含まれない仕様に戻されました。*NetKit* のように，MIMEにBccヘッダーを含める必要がある場合，下記のようにオプションで指定することができます。

```4d
MAIL Convert to MIME($inMail; {includeBccHeaders: True})
```

`SMTPTransporter`もメッセージからBccヘッダーを取り除くように改良されました。

* ACI0105108 `Get monitored activity`から`message`プロパティを持たない（したがって調査の助けにならない）統計情報が返されることがありました。

* ACI0105130 `TODO`コメントにセミコロン記号（`;`）を含めた場合，メソッドエディターのツールバー表示が乱れました。記号がポップアップメニューのメタ文字として処理されるためです。

* ACI0105091 *Qodly* の標準アクションで強制ログインモードのセッションをログアウトした場合，権限がクリアされませんでした。`ds.logout()`でセッションをログアウトすれば問題ありません。

* ACI0105081 データモデルクラスのメンバー関数に「昇格」アクションを設定した場合，関数の実行中に`Session.hasPrivilege()`が一時的な権限の情報を返しませんでした。

* ACI0105121 ストラクチャファイルを20r6にアップグレードした後，起動時にストラクチャファイルをアップグレードするかどうかを尋ねるダイアログが表示されました。

* ACI0105137 順列ありエンティティセレクションに対して`entitySelection.clean()`を使用した場合，トランザクション中に削除されたエンティティがエンティティセレクションから除外されず，その位置に`Null`が返されました。

* ACI0105118 レコードアドレスが`32`ビットの範囲を超える場合，`entitySelection.clean()`が正しく動作しませんでした。

* ACI0105038 行高の管理配列が設定されたリストボックスのスクロール速度が列数に比例して低下しました。列数が`100`個以上の場合に問題が顕著です。行の高さが固定あるいは自動であれば問題ありません。