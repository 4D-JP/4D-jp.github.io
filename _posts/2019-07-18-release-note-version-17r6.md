---
layout: fix
title: "4D v17r6 修正リスト"
date: 2019-07-18 -08:00:00
categories: 修正リスト
tags: 17r6
build: 239692
version: 17r5
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}}  

* ACI0099803 フォームエディターでページを削除したときに繰り上がって表示されるページにリストボックスが存在する場合，アプリケーションがクラッシュしました。

* ACI0099794 アプリケーションパッケージ内に``%``記号から名前が始まる画像ファイルがあるためにWiseでインストーラーを作成することができませんでした。

* ACI0099773 テキスト入力エリアのプロパティで自動ドラッグと自動ドロップを有効にした上で「ドラッグ可」と「ドロップ可」を無効にした場合，ドラッグ＆ドロップができませんでした。

* ACI0099761 プロセス数がデータベースの設定された上限値（デフォルトは``5``）に達している状況で``PHP Execute``を実行した場合，プロセスがハングしました。

* ACI0099759 クライアント/サーバー版のみ。ORDAとクラシックランゲージの「橋渡し」コマンドを続けて実行した場合，エラー ``1303``が返されることがありました。たとえば，同じエンティティセレクションに対して``USE ENTITY SELECTION``を続けて使用した場合，１回目のコールで作成されたカレントセレクションのIDが解放されてから，２回目のコールで新しいカレントセレクションが作成されるべきですが，コマンドを続けて使用した場合，解放される前に新しいカレントセレクションが作成されてしまい，結果的にコンテキストIDが無効になってしまいました。

* ACI0099749 クライアント/サーバー版のみ。プロセスの作成や削除にタイミングで，稀にサーバーのデッドロックが発生することがありました。

**注記**: ユーザーをロックする前にサーバーをロックするよう，内部的なオブジェクトロックの仕組みが修正されました。

* ACI0099731 フランス語版のみ。Windowsで自動アップグレード用にMac版にクライアントアプリケーションをビルドしたときに表示されるメッセージにスペルミス（clienteではなくclient, de l'applicationではなくdu l'application）がありました。

* ACI0099722 Mac版のみ。アプリケーション自動アップグレードが完了した後，エラーメッセージが表示されました。

* ACI0099714 Microsoft Excelなどの表計算ソフトからタブ区切りテキストをコピーして4D Write Proの表にペーストした場合，文字列全体が単一のセルにすべて挿入されました。期待されるのは，区切られた文字列がそれぞれ隣接するセルに挿入されることです。

* ACI0098029 SQLの``LEFT OUTER JOIN``から返される結果が正しくありませんでした。LEFTテーブルに合致するレコードがRIGHTテーブルに存在しないとしても，LEFTテーブルの行はすべて返され，合致するレコードが存在しないRIGHTテーブルの行には``Null``が返されるべきですが，そのような行は返されませんでした。

* ACI0098328 4D WriteドキュメントをWrite Proに変換した場合，一部のテキストにブルーの背景色が追加されました。段落スタイルシートとテキストの両方に背景色が設定されている場合に問題が発生します。

* ACI0098413 ``SVG_SAVE_AS_PICTURE``は，ファイルまたはフォルダーの名前に複数の拡張子が存在する場合に画像が保存できませんでした。内部的に使用されている正規表現が間違っているためです。

* ACI0098452 Mac版のみ。リストフォームに配置されたピクチャ型フィールドの表示に問題がありました。リスト上でレコードの編集を開始すると，ピクチャ型フィールドの画像が消えました。``.svg``形式の場合，レコードの編集を終了すると，すべての行に同じ画像が表示されました。

* ACI0098925 バックアップ設定の「指定時間経過後に再試行」オプションは設定ファイルに保存されませんでした。Windowsでは常に``0``秒となり，macOSでは常に``60``分となりました。

* ACI0099050 ラベルエディターを閉じてから，再び開いた場合，最後に使用したラベル設定ファイルがロードされた状態でダイアログが表示されませんでした。

* ACI0099200 ラベルエディターの用紙を横向きに設定した場合，水平方向に印刷されるラベルの数が正しくありませんでした。

* ACI0099228 クロスタブ形式のクイックレポートは，時間型フィールドの``Sum``が正しくありませんでした。32ビット版では，空のレポートが出力されます。64ビット版では，``1``時間が約``3.57``秒として計算されました。

* ACI0099235 ``HTTP Get``が過剰にCPUパワーを消費しました。

**注記**: 修正により，ネットワークレイヤーのSelectIOモードが有効にされました。つまり，プロセスのループ処理でソケットの読み込みを実行する代わりに，ネットワークレイヤーからデータの有無に関する情報を受け取るようにコードが修正されました。``ACI0098747``の修正により，CPU使用率は90%程度から67~74%程度に改善されましたが，今回の修正でv17と同程度（ほぼ0%）になりました。

* ACI0099298 トランスポーターで送信した件名（日本語）が正しくエンコードされないことがありました。ヘッダーが``78``バイトを超える場合，UTF-8 quoted-printableの``3``バイトシーケンス（``9``文字）が分割されてしまうことがあるためです。

* ACI0099314 64ビット版のみ。``SET MENU BAR``を実行してから``EDIT ACCESS``でツールボックスの「ユーザー＆グループ」ページを表示した場合，設定したメニューバーではなく，デザインモードのメニューバーが表示されました。また，ダイアログを閉じると，復帰したメニューバーの項目は一部が選択不可の状態になりました。

* ACI0099331 リスト型のサブフォームをダブルクリックした場合，``FORM SET INPUT``で設定した詳細フォームではなく，デザインモードで設定したデフォルトの詳細フォームに画面が切り替わりました。

* ACI0099334 ``dataClass.query()`` ``entitySelection.query()``の``IN``条件にコレクションを渡した場合，あるいは``QUERY WITH ARRAY``で検索を実行した場合，日本語の検索結果が正しくありませんでした。データベースの言語が日本語に設定されており，「テキスト検索用の文字列比較を使用する」が有効にされている場合に問題が発生します。

* ACI0099358 ラテンシーが高い（つまり転送が遅い）ネットワークに接続された別々のプラットフォームでクライアントとサーバーを起動し，新ネットワークレイヤーでクエリを実行した場合，旧式ネットワークレイヤーよりも時間がかかりました。

* ACI0099379 非表示セルが含まれる4D Viewドキュメントを4D View Proに変換した場合，セルのプロパティ``visible``が``false``に設定されましたが，これはSpreadJSがサポートしていないプロパティであり，セルが非表示になることもありません。4D View Proでは，4D Viewのようにセルを非表示に設定することはできません。

* ACI0099393 4D WriteドキュメントをWrite Proに変換した場合，先頭ページを除くすべてのページに表示されるピクチャが先頭ページにも表示されました。

* ACI0099400 Windows版のみ。``DISPLAY SELECTION``または``MODIFY SELECTION``でリストフォームを表示しているウィンドウが最前面ではない状態で``CLOSE WINDOW``を実行してウィンドウを閉じようとすると，アプリケーションがクラッシュすることがありました。

* ACI0099403 サーバー管理画面を表示した状態でクライアントの接続を解除し，画面を「ユーザー」ページに切り替えた場合，接続ユーザー数が減算されていないために配列の範囲チェックエラーが返されました。

* ACI0099404 インデックスを再構築した後，一部のインデックスページがまだフラッシュツリーに残されている状態でインデックスを削除した場合，アプリケーションがクラッシュすることがありました。

* ACI0099407 Windows版のみ。``LISTBOX SELECT ROW``に``lk remove from selection``を渡した場合，数秒後にアプリケーションがクラッシュしました。

* ACI0099409 破損した4D Viewドキュメントを``VP Convert from 4D View``で処理した場合，アプリケーションがフリーズする恐れがありました。

* ACI0099415 テキスト入力の背景が明るい色（たとえば黄色）に設定されている場合，キャレットが良く見えませんでした。

**注記**: キャレットの色は，背景の輝度によって決められていました。修正により，背景のグレースケールの輝度によって決められるようになりました。

* ACI0099428 リストボックスの列に対するポインターを``Form``のプロパティに代入し，オブジェクト記法とポインターの逆参照を併用して行の値を代入した場合，右オペランドではエラー``56``が返され，左オペランドでは配列が更新されませんでした。オブジェクト記法をカッコで括れば問題ありません。

* ACI0099430 Windows版のみ。Internet Explorer 11がインストールされたプラットフォームでシステム版のWebエリアにページを表示した場合，``WA Get Page Title``はHTMLのタイトルではなく，URLを返しました。

* ACI0099527 Write Proドキュメントを``.docx``形式でエクスポートした場合，青色の不要な罫線が出力されることがありました。

* ACI0099535 クライアント/サーバー版のみ。エンティティのリレート属性を``If``構文の中で評価した場合，``Null``と評価されることがありました。ORDAの最適化により，一部の属性が遅延ロードされることが原因です。``If``構文の外でリレート属性を参照すれば，``If``構文の中で評価しても問題ありません。

* ACI0099536 64ビット版のクイックレポートエディターは，``Tab``以外のセパレーター記号を設定することができませんでした。

**注記**: ``QR AREA``は，デフォルトでシステム変数の``FldDelimit``と``RecDelimit``を使用しますが，これは``QR SET PROPERTY``でオーバーライドすることができます。修正により，``QR SET DESTINATION``の前に``QR SET PROPERTY``を使用すれば，``FldDelimit``と``RecDelimit``がオーバーライドできるようになりました。

* ACI0099544 64ビット版のみ。表示フォーマットが設定された実数フィールド（例：``String([TEST]Prix;"##0.00€;-##0.00€")``）がラベルに挿入されていた場合，最初の1枚でラベルの出力が終了しました。

* ACI0099547 Mac版のみ。プロジェクトモードでストラクチャファイルの内部リソースにアクセスするようなプラグインコマンドを実行するとアプリケーションがクラッシュしました。

* ACI0099548 ``If``文などのコードブロック内でシンタックスエラーが検出された場合，``If``および``End if``もシンタックスエラーとして計上されました。

* ACI0099551 Welcome ウィザードが表示された直後にアプリケーションを終了した場合，アプリケーションがクラッシュすることがありました。

* ACI0099554 クライアント/サーバー版のみ。アプリケーションプロセスで``REDUCE SELECTION``を実行してカレントセレクションのサイズを``0``に設定した場合，カレントレコードがアンロードされませんでした。

* ACI0099556 トランザクション中に日付型の属性に対して``collection.sort()``メソッドを実行した場合，結果が正しくありませんでした。

* ACI0099557 Windows版のみ。``.css``ファイルを参照する``link``タグが記述されたHTMLをWebサーバーに対して繰り返しリクエストした場合，アプリケーションがクラッシュしたりフリーズしたりすることがありました。TLS ``1.3``を無効にすれば，問題ありません。

* ACI0099700 クライアント/サーバー版のみ。エンティティセレクションに対し，``For each``ブロック内で各エンティティのリレーション属性に対するクエリを``entitySelection.query()``で実行した場合，返されるエンティティセレクションが正しくありませんでした。途中で``entitySelection.toCollection()``など，明示的にエンティティセレクションをフェッチするようなコードを実行すれば問題ありません。17R5で実施されたORDAの最適化に問題がありました。

* ACI0099693 クライアント/サーバー版のみ。空のエンティティセレクションの１対Nリレーション属性（当然，空）のN対１リレーション属性にアクセスしようとした場合，アプリケーションがクラッシュしました。

* ACI0099689 macOS 10.15 Catalinaでアプリケーションを起動すると，すぐにクラッシュしました。

**注記**: ファイルシステムの「データ領域」に対応し，メニュー項目のキーボードショートカットによる入力処理が修正されました。

* ACI0099675 64ビット版のみ。クイックレポートエディターで計算カラム（例：``[Table_1]price*[Table_1]quantity``）にフォーマット（例：``###0``）を設定した場合，カラムのフォーミュラがクリアされました。

* ACI0099674 ``COLLECTION TO ARRAY``の第``3``パラメーターにテキスト型が渡された場合，コンパイラーからエラーが返されました。リテラルテキストであれば，問題ありません。

* ACI0099664 フォームエディターに入れ子にされたサブフォームの内容が表示されませんでした。

* ACI0099661 プロジェクトモードでフォームエディターを開いた場合，サブフォームオブジェクトのプロパティリストに共有が許可されたコンポーネントのフォーム名が表示されませんでした。
