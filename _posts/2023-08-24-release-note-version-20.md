---
layout: fix
title: "4D v20 修正リスト"
date: 2023-09-22 08:00:00
categories: 修正リスト
tags: "20.1" 
build: 100779
version: "20.1"
permalink: /2023/236/:slug/
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}} 

* ACI0104187 `Get process activity`を実行している間に新規プロセスを起動してHTTPリクエストを実行した場合，アプリケーションがクラッシュする可能性がありました。

* ACI0103945 特定のDOCXドキュメントをWrite Proにインポートした場合，一部のテキストが表示されませんでした。

**注記**: 右から左に読まれる言語のマークアップに使用されるタグが関係しています。このタグは2012年版のOOXMLでは定義されていませんでした。修正により，テキストは表示されるようになりましたが，Write Proは段落の途中で方向を切り替えるタグをサポートしているわけではないので，右から左のドキュメントに左から右のテキストが挿入されている場合にのみ，正しく内容が表示されることになります。

* ACI0104174 `From`ヘッダーを指定せずに`SMTP Transporter`でメールを送信した場合，エラーが返されました。

* ACI0104236 Plugin SDKで文字列型の変数を読み取った場合，メモリ破損が発生し，最終的にクラッシュすることがありました。

* ACI0104237 三項演算子の戻り値を未宣言の変数に代入するようなコードを記述した場合，コンパイラーがエラーを返しました。ACI0103960が修正されたことによる副作用です。

```4d
$a:=true ? 1 : 2
```

* ACI0104235 リレーションや`OR`演算子を組み合わせた複雑なORDAクエリの最適化に問題がありました。たとえば`0.001`秒で終了するはずのクエリに`3`秒を要することがあります。

* ACI0104217 「サーバー側で実行」メソッド属性で大量のサーバー側プロセスを短時間に起動した場合，サーバーがクラッシュすることがありました。プロセスリストを頻繁に更新する過程で競合状態が発生しているようです。

* ACI0104088 ストアドプロシージャーを実行中のクライアントがスリープしている間にサーバー管理画面でそのユーザーをドロップし，クライアントのスリープ状態を解除してサーバーに再接続した場合，同じユーザーが二重に接続したような状態になりました。

* ACI0104214 計算属性をデータソースとするフォームオブジェクトを`Print form`で印刷した場合，アプリケーションがクラッシュしました。

* ACI0104229 ツールバーボタンの幅いっぱいにアイコンやタイトルを表示した場合，リンクしたポップアップメニューが途切れて表示されました。

* ACI0104213 入力オブジェクトのデータソースにピクチャ型を設定しても，オブジェクトがテキスト入力として初期化されることがありました。テキスト型として振る舞うために，ピクチャをドラッグ＆ドロップ操作で入力することができません（マウスポインターがテキスト入力のように反応します）。

* ACI0104194 自動コード補完の候補リストの上位にテーブルが表示されませんでした。`QUERY`や`ORDER BY`など，テーブルをパラメーターとして受け取るコマンドを入力しているときは，通常とは違い，`[`記号を省略した場合でもテーブルがトップヒットになるべきです。

* ACI0104136 *4D NetKit* の Microsoft Graph APIでメールを受信した場合，最後のメッセージに`isLastPage`属性が設定されませんでした。

* ACI0104091 コレクション型の`FORM GET PROPERTIES`を実行した場合，リストボックスの選択状態が解除されました。

* ACI0104177 プロジェクトモードのみ。ストラクチャエディターで設定したフィールドのヘルプTipsがフォーム実行時に表示されませんでした。

* ACI0104123 Windows版のみ。`CONFIRM`画面の左側に表示されるOKボタン（Macではキャンセル）がデフォルトでフォーカスされていました。

* ACI0104025 macOS Sonomaのみ。タブコントロールの選択されたタブの背景色がライトモードで表示されませんでした。

* ACI0104132 書き出しダイアログで*.4SI*ファイルをロードした場合，右上のタブコントロールが表示が正しく更新されませんでした。ファイルタブが選択された状態でフォーマットタブのドロップダウンメニューが表示されました。

* ACI0104127 `OBJECT GET BEST SIZE`がポップアップメニューがリンクされたボタンの最適なオブジェクト幅を返しませんでした。

* ACI0104096 `filehandle.readText()`のオフセット値が正しく更新されませんでした。ストップ文字の後ではなく手前の位置が返されるべきです。

* ACI0104086 バイナリモードのみ。デザインモード間でフォームやメソッドをドラッグ＆ドロップしようとしたときに表示される移動ダイアログで項目を並び替えることができませんでした。リストボックスのヘッダーをクリックしても何も起きません。

* ACI0104138 ループ処理で`VP PASTE FROM OBJECT`を実行した場合，メモリが大幅に消費されました。`VP MOVE CELLS`も同じ問題を抱えています。

**注記**: メモリ占有を抑えるため，`100`コール毎にフラッシュ（`VP FLUSH`）が自動的に実行されるようになりました。

* ACI0104196 Write Proサイドバーインタフェースでドキュメントの背景をコピー＆ペーストすることができませんでした。

* ACI0104195 Write Proサイドバーインタフェースの背景タブを表示した状態で選択したテキストに複数の単位や設定が混在している場合，エラーが返されました。

* ACI0104193 Windows版のみ。ツールバー・Office XP・サークル型のボタンがフォーカスされているフォームでデフォルトボタンに青いアウトラインが表示されませんでした。

* ACI0104110 デバッガーに入力された式を素早く削除した場合，アプリケーションがクラッシュしました。

* ACI0104191 TLS接続が延期された場合，ソケットが閉じられた後にTLS接続を閉じようとすることによるメモリ破損が発生する恐れがありました。ACI0103972（クライアント接続が切断される問題）が修正されたことによる不具合です。

* ACI0104161 コレクション型を使用して`HTTPRequest`クラスの`headers`プロパティに複数のクッキーを設定することができませんでした。`Cookie`ヘッダーの値はセミコロンとスペース（`; `）で区切られ，その他のヘッダーはカンマとスペース（`, `）で区切られるべきです。

* ACI0104128 制御配列で自動行高プロパティが有効にされた配列型リストボックスの行を非表示にした場合，リストボックスの下部に空白エリアができました。

* ACI0104165 クライアント/サーバー版のみ。管理画面の「プロセスをデバッグ」ボタンが常に *disabled* 状態であるため，ストアドプロシージャーやサーバー側で開始したプロセスをデバッグすることができませんでした。*Alt*+*Shift*+右クリックでプロセスをトレースすることはできます。

* ACI0104164 エクスプローラーの「プラグイン」ページにアイコンが表示されませんでした。

* ACI0104094 Write Proドキュメントでテキストが何も選択されていない状態で`WP Get formulas`を実行した場合，カーソルの直前にあるフォーミュラが返されました。

* ACI0104082 Write Proの背景画像の表示オプションを *wk cover* または *wk contain* に変更した場合，サイドウィジェットの水平リサイズ（ *wk background width* 属性）に設定値が表示されませんでした。

* ACI0104181 リストボックスのセルにSVG画像を表示した場合，スクロール操作に伴ってメモリが表示され，最終的にアプリケーションがクラッシュしました。

* ACI0104179 ポインター型の`PA_Variable`を使用して`PA_ExecuteCommandByID`で`RESOLVE POINTER`コマンドを実行した場合，新しいポインター型の`PA_Variable`が返されました。過去のバージョンでは元の`PA_Variable`がそのまま返されました。

* ACI0104176 クライアント/サーバー版のみ。接続が切断されたクライアントのソケットハンドラーが即座に解放されず，無数のハンドシェイクが試みられました。	

* ACI0104147 Mac版のみ。最前面ではない *Controller form window* タイプのウィンドウに表示された入力オブジェクトでは *On Mouse Up* フォームイベントが必ずしも発生しませんでした。フォームに表示されたオブジェクトの総数やクリックの速度に左右されるようです。対照的に *On Clicked* イベントは常に発生します。

* ACI0104073 `CALL SUBFORM CONTAINER`で負のフォームイベントを送信した場合，`FORM Event.description`に`:xliff:PL_event_-4`のようなXLIFF参照が返されました。

* ACI0104011 Mac版のみ。環境設定でアピアランスが「継承」に設定されており，フォームのプロパティが「ダーク」に設定されている場合，`DIALOG`コマンドを使用して表示したウィンドウがダークモードで表示されませんでした。`DIALOG`コマンドに前に`Open form window`で目的のフォームを指定してウィンドウを表示すれば問題ありません。

* ACI0104171 Mac版のみ。高解像度Retinaディスプレイと通常のディスプレイをMacに接続し，一方から他方にウィンドウを移動した場合，表示されるフォントサイズが正しくありませんでした。

* ACI0104159 ブール型フィールドがラジオボタンとして表示されるように設定されたフォームをプロジェクトモードに変換した場合，フィールドがチェックボックスとして表示されるようになりました。

* ACI0103234 *MyTable* という名称のテーブル存在するプロジェクトで *MyTableEntity* という名称のクラスを作成しようとした場合，予約されたクラス名であるというエラーメッセージが表示されました。この場合，同じ名前のクラスがすでに存在する，というメッセージのほうがより適切です。

* ACI0104155 コレクション型リストボックスの行を`LISTBOX SELECT ROWS`で選択した直後にキーボード操作で行を選択した場合，コマンドを実行する前に選択されていた行を起点として行が選択されました。

* ACI0104134 関数と[短絡演算子](https://developer.4d.com/docs/ja/Concepts/operators/#短絡演算子)につづけてブール型フィールドを記述した場合，シンタックスエラーが返されました。フィールド名の前半がテーブル名ではなくコレクションとして解釈されているためです。

* ACI0104153 プロジェクトモードのみ。入力オブジェクトのテキスト横揃えプロパティの設定がフォームエディターの表示に反映されませんでした。

* ACI0104152 XLIFFで設定された3Dボタンのタイトルを`OBJECT SET FORMAT`で更新した場合，XLIFFリソース名がそのままタイトルとして表示されました。

* ACI0104148 Mac版のみ。`ERASE WINDOW`を使用した場合，テキストがグレーアウト表示されました。 

* ACI0104141 ブール型フィールドのタイトルを`OBJECT SET FORMAT`で更新することができませんでした。
