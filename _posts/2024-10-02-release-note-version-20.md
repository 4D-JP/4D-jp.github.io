---
layout: fix
title: "4D 20 修正リスト"
date: 2024-11-18 08:00:00
categories: 修正リスト
tags: "20.5"
build: 101570
version: "20.5"
permalink: /2024/276/:slug/
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}} 

* ACI0105183 Macクライアント/サーバー版のみ。サーバーがフリーズすることがありました。コオペラティブプロセスのスケジューラーがデッドロックに陥る条件があるようです。

* ACI0105175 複数の段落が選択された状態でWrite Proエリアに対して`Get action info`を実行した場合，`status`に`"mixed"`が返されませんでした。また，マージン情報は選択の冒頭にある段落のものが返されました。

**注記**: 問題は修正されましたが，パフォーマンス最適化のため，指定されたレンジの冒頭`2000`文字に基づいて`"mixed"`かどうかが判定されます。それよりもおおきなレンジの場合，正しい`status`が返されないかもしれません。

* ACI0105174 フォームに複数のWrite Pro標準アクションオブジェクトが存在する場合， `Get action info`から返されるWrite Proエリアの標準アクション情報が正しく更新されないことがありました。

* ACI0104919 スタートアップ直後のアクティビティが診断ログに記録されないことがありました。

**注記**: ロガーには`1000`項目分のフレームバッファが設定されています。短時間に`1000`以上のアクティビティログを出力した場合，もっとも古いアクティビティは記録されないかもしれません。4D 20は，4D 19よりも動作が速いため，この上限に達する可能性が高くなりました。修正に伴い，この上限値が見直されました。

* ACI0105084 `POP3 Transporter`でメール受信に失敗した場合，メモリーリークが発生しました。接続オブジェクトとそのバッファが解放されていないためです。他のトランスポーターでも問題が再現します。

* ACI0105210 フランス語版のみ。アプリケーションビルド画面の「コード署名」の説明文が正しくありませんでした。正しいフランス語は*le processus requière* ではなく*le processus requiert* です。

* ACI0105130 `TODO`コメントにセミコロン記号（`;`）を含めた場合，メソッドエディターのツールバー表示が乱れました。記号がポップアップメニューのメタ文字として処理されるためです。

* ACI0104992 `QR REPORT`の画面にストラクチャとバーチャルストラクチャの表示名が混在していました。

* ACI0105176 Write Proエリアの編集中に違うヘッダーの同じ相対位置にカーソルを移動してテキストを挿入した場合，*On Selection Change* イベントが発生しませんでした。

* ACI0104443 セレクション型リストボックスセルの*On Before Keystroke* イベントで`FILTER KEYSTROKE("")`を実行した場合，セルの内容が消去されました。

* ACI0105179 トランザクション中に更新されたエンティティがメモリから解放されるタイミングでアプリケーションがクラッシュすることがありました。

* ACI0105064 SOAPサーバーがXML External Entity (XXE) 攻撃の標的になる可能性がありました。

* ACI0104985 *Excel* などのOfficeデスクトップアプリケーションから*Power Query* でSQLを実行した場合，`5`桁を超える数値が正しく返されませんでした。*MS Query* であれば問題ありません。

* ACI0105022 UUIDフィールドに対し，空の文字列を含むコレクションを使用してORDAクエリを実行した場合，間違った結果が返されました。

* ACI0105161 ツールボックスの「ユーザー＆グループ」ページでグループ名をダブルクリックしてから項目を更新した場合，変更が反映されませんでした。コンテキストメニューを使用すれば問題ありません。

* ACI0105083 `orient`属性が`auto-start-reverse`に設定されたSVGを表示しようとした場合，アプリケーションがクラッシュしました。

**注記**: `auto-start-reverse`属性はサポートされていませんが，修正により，レンダリングエンジンがサポートしていないCSS属性は，エラーを返さないようになりました。

* ACI0104326 クライアント/サーバー版のみ。*Administrator* 権限でユーザーの所属グループを変更することができませんでした。

* ACI0105061 `300,000`件以上のレコードがすでに登録されているフィールドの「ヌル値を空値にマップ」プロパティを有効に変更して，`QUERY WITH ARRAY`または`QUERY SELECTION WITH ARRAY`でシーケンシャルクエリを実行した場合，正しい結果よりも`1`件レコードが少ないセレクションが作成されました。

* ACI0105039 コンピューター名にアクセント記号を含むサーバーに対して`Open datastore`で接続することができませんでいた。

**注記**: 修正により，`Remote-Hostname`などのHTTPヘッダーは`\uXXXX`形式に変換され，`US-ASCII`エンコーディングで送信されるようになりました。

* ACI0105038 行高の管理配列が設定されたリストボックスのスクロール速度が列数に比例して低下しました。列数が`100`個以上の場合に問題が顕著です。行の高さが固定あるいは自動であれば問題ありません。

* ACI0105153 Mac版のみ。パレットタイプのウィンドウ（*Controller form window* *Pop up form window* *Toolbar form window* *Palette form window*）をフォーカスした場合，フォーカスされていないウィンドウのデフォルトボタンのタイトルがボタンと同色になりました。ダークモードでは問題ありません。

* ACI0105128 *OAuth2* トークンと`SMTPTransporter`で*Gmail* を送信した場合，受信者のメッセージにBccヘッダーが表示されました。ACI0104608が修正されたことによる副作用です。

**注記**: 本来，Bccヘッダーはメールサーバーが除去するべきですが，すべてのメールサーバーがそのように設計されているわけではないようです。修正により，JMAPメッセージオブジェクトから変換されたMIMEにはBccヘッダーが含まれない仕様に戻されました。*NetKit* のように，MIMEにBccヘッダーを含める必要がある場合，下記のようにオプションで指定することができます。

```4d
MAIL Convert to MIME($inMail; {includeBccHeaders: True})
```

`SMTPTransporter`もメッセージからBccヘッダーを取り除くように改良されました。

* ACI0105100 リレーション属性が関係するORDAクエリが間違っていることがありました。ACI0104799が修正されたことによる副作用のようです。

```4d
ds.One.all().drop()
ds.Many.all().drop()
$One:=ds.One.new()
$One.Id:=1
$One.save()
$Many:=ds.Many.new()
$Many.Id:=1
$Many.OneId:=1
$Many.save()
$Query:="One.Id#0 & ((Id#0 & (Id=0 | One.Id=0)) | (Id#0 & (Id=0 | One.Id=0)))"
ALERT($Query+"\r\rExpected: 0\rResult: "+String(ds.Many.query($Query).length))
```

* ACI0105024 カタログファイルのインデックス名とデータファイルのインデックス名が異なる場合，カタログファイルがデータファイルのインデックス名で更新されました。たとえ再インデックスが必要になるとしても，開いたデータファイルの内容でカタログファイルが更新されるべきではありません。

* ACI0105027 フォームエディターのコンテキストメニューで「同じ種類のオブジェクトを選択」した場合，ツールバーの整列/均等配置ボタンがアクティブ化されませんでした。

* ACI0105116 Mac版のみ。サーバー管理画面のメンテナンスページがダークモードに対応していませんでした。

* ACI0105097 Mac版のみ，スクリーンの横に*Dock* が表示されている場合，ツールバーが正しく表示されませんでした。左に*Dock* があれば，ツールバーの右が画面の外に出てしまい，右に*Dock* があれば，ツールバーの右に隙間が生まれました。

* ACI0103752 4D ViewスプレッドシートをView Proに変換した場合，パーセンテージのフォーマットが正しく適用されませんでした。

* ACI0105052 Windows版のみ。サブモニター側に表示されたSDIモードのフォーム上で日付ピッカーを使用した場合，メインモニター側にピッカーが表示されました。

**注記**: [コンポーネント](https://github.com/4d/4D-Widgets/commit/020ab608b8158a2dfb61ad512cb072f648bc3e38)が修正されました。

* ACI0105021 プロジェクトモードのみ。*.lproj* フォルダー内に置かれた画像ファイルがリソースフォルダーに置かれた画像ファイルよりも優先されませんでした。

* ACI0105011 フォームエディターで空のリストボックス列を選択して削除した場合，アプリケーションがクラッシュしました。

* ACI0105140 Windows版のみ。Windows 24H2で印刷コマンドを実行してPDFを出力しようとした場合，`OPEN PRINTING JOB`からエラーが返されることがありました。

* ACI0105080 リストボックスのヘッダーアイコンを`OBJECT SET FORMAT`と`"path:/RESOURCES/"`形式で変更することができませんでした。`#Images/`形式であれば問題ありません。

* ACI0105072 ネットワークに接続していない環境でライセンスのアクティベーションを試みた場合，エラーメッセージが英語で表示されました。