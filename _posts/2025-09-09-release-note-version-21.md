---
layout: fix
title: "4D 21 修正リスト"
date: 2025-11-30 08:00:00
categories: 修正リスト
tags: "21.0"
build: 100225
version: "21.0"
permalink: /2025/279/:slug/
---

* ACI0106046 Mac版のみ。Apple Siliconプラットフォームで`QUERY BY ATTRIBUTE`の比較演算子を省略した場合，アプリケーションがクラッシュしました。

* ACI0106065`JSON Validate`が`multipleOf`キーワードを正しく判定できませんでした。

* ACI0106066 サーバー管理画面が更新されるタイミングでプロセスが終了した場合，アプリケーションがクラッシュする恐れがありました。

* ACI0106068 ASTインタープリターモードでは，無効なポインター逆参照コードがエラーを返さず，メモリーリークの原因になることがありました。

* ACI0106071 エンティティセレクションをオブジェクト型フィールドのプロパティで並び替えた場合，[コレクション並び替えのルール](https://developer.4d.com/docs/ja/API/CollectionClass#orderby)（オブジェクトはコレクションよりも上位）が適用されませんでした。

* ACI0106077 プロジェクトモードでは，印刷用詳細フォームのマーカーがプロパティリストに表示されませんでした。バイナリモードでは問題ありません。

* ACI0106053 `ZIP Create archive`がエラーに終わった場合，成功時のステータス（`{"success":true, "statusText":"success"}`）が返されました。

* ACI0106060 クエリ条件の連結演算子`|`の両側に空白を挿入しなかった場合，エラーが返されました。

* ACI0106059 フォームオブジェクトのデータソースにオブジェクト型フィールドの参照とブラケット記法（`[MyTable]MyObjectField["myProp"]`）を使用した場合，フォーム表示と同時にアプリケーションがクラッシュしました。ドット記法（[MyTable]MyObjectField.myProp`）であれば問題ありません。

* ACI0105974 エンティティイベントの[`validateSave`](https://developer.4d.com/docs/ja/ORDA/orda-events#function-event-validatesave)で保存を拒否した場合，リモートデータストアやQodlyアプリケーションには詳細を表示できないバイナリ形式（`__PRIVATE_BINARY_OBJECT`）でステータスオブジェクトが返されました。

**注記**: ペイロードの`__STATUS.errors[0].extraDescription`と`__ERROR[0].extraDescription`で同じオブジェクトが参照されていることが原因でした。バイナリ形式は，JSON文字列に変換できないオブジェクト（再帰的構造・クラス・バイナリオブジェクトなど）を転送するために使用されます。

* ACI0105972 Mac版のみ。ビルド設定の著作権情報（`CommonCopyright` `RuntimeVLCopyright` `ServerCopyright` `ClientCopyright`）がアプリケーションビルド画面および`BUILD APPLICATION`に反映されませんでした。*Build4D* コンポーネントは問題ありません。

* ACI0105812 ビルドしたデスクトップアプリケーションのサブスクリプション期間が終了した場合，ライセンスを更新するためのダイアログが表示されますが，ラインセンス更新後にアカウント入力画面が閉じられないため，一旦，アプリケーションを再起動する必要がありました。

* ACI0105178 `\`で改行したメソッドの途中を`/*`と`*/`でブロックコメントにすることができませんでした。

* ACI0104807 パラメーターの値を変更するメソッドをトレースした場合，名前付き引数の値はデバッガ上で更新されますが，連番ローカル変数（`$1` `$2`） の値は初期値から更新されませんでした。

* ACI0106089 メソッドエディターのコーディング言語をフランス語に設定した場合，F1キーまたは*Control*/*alt*+クリックで正しいドキュメンテーションのページにジャンプしませんでした。

* ACI0106086 `Choose`コマンドに数値型の値とブール型の数式を渡した場合，コンパイルエラーが返されました。ACI0105909が修正されたことによる副作用のようです。

```4d
$continue:=Choose($number; True; Not(True))
```

条件とパラメーターの渡し方を値か数式のどちらかに揃えれば問題ありません。

```4d
$continue:=Choose($number; True; False)
$continue:=Choose($number=0; True; Not(True))
```

* ACI0105962 Windows版のみ。メソッドエディターに長文を入力した場合，カーソルや選択テキストのハイライトが間違った位置に表示されました。Meiryo UIフォントで問題が再現します。等幅フォントでは問題ありません。"/A"や"AW"といった文字のカーニングが多いほど，顕著に位置の計算がずれるようです。

* ACI0106103 スケーラブルセッション管理モードでセッション固有のデータをプロセス変数に代入した場合，別セッションのWebプロセスからその内容を参照することができました。

**注記**: パフォーマンス向上のため，Webプロセスが再利用されることは，ドキュメントに明記されていますが，セキュリティを高めるため，スケーラブルセッション管理モードでは，Webプロセスが再利用されないようになりました。Webリクエストの完了と同時にプロセス変数はクリアされ，カレントレコードはアンロードされます。Webサーバー起動時に予備プロセスが作成されることもありません。

* ACI0106061 IMAPトランスポーターの`getMails'()`メソッドで大量（たとえば`500`件）のメールを受信しようとした場合，アプリケーションがクラッシュしました。

**注記**: 範囲チェックをしない関数である`strstr()`を内部的に使用していたことが原因でした。

* ACI0106085 バイナリモードのみ。コンポーネントをビルドしようとした場合，アプリケーションがクラッシュしました。ACI0105475が修正されたことによる副作用のようです。

* ACI0106090 エクスプローラーの「ホーム」タブを選択し，「デフォルトプロジェクトメソッド」を右クリックして新規フォルダーを作成した場合，内部的にフォルダーは作成されますが，エクスプローラーの表示が更新されませんでした。

* ACI0105994 コンボボックスの日本語入力を確定したタイミングで*On After Edit* イベントが発生しませんでした。

* ACI0106026 *tool4d* で*Build4D* を使用してOEM版のサーバーアプリケーションをビルドした場合，途中でエラーが発生し，ライセンスフォルダーにライセンスがインストールされませんでした。

**注記**: 修正により，*tool4d* で[`Create deployment license`](https://developer.4d.com/docs/ja/commands/create-deployment-license)および`BUILD APPLICATION`が使用できるようになりました。

* ACI0106039 リストボックスのセルデータ入力中に行の追加または削除と縦スクロールを同時にコマンドで実行した場合，アプリケーションがクラッシュする恐れがありました。

* ACI0106038 Windows版のみ。ボタンのエッジ部分が滑らかにレンダリングされるようになりましたが，マルチステートボタンの画像が余白なく並べられている場合，隣接する画像のアンチエイリアス処理が互いに干渉しました。

**注記**: Windowsでデスクトップの拡大率を100%よりも高く設定した場合，あるいはMacでRetinaディスプレイを使用した場合のビットマップ画像のレンダリングが修正されました。SVGのようなベクトル画像は対象外です。

* ACI0106058 `ARRAY TO LIST`および`LIST TO ARRAY`が
リスト名の大文字と小文字を区別しました。バイナリモードでは問題ありません。

**注記**: 問題は修正されましたが，*lists.json* に重複するリストが存在する場合，ひとつのリストにまとめる必要があります。

* ACI0106054 macOS 26 Tahoeのみ。Dockのアイコンを右クリックし，「すべてのウィンドウを表示」を選択した場合，閉じたはずのウィンドウの残骸が表示されました。`NSWindow`が正しく開放されていないようです。

* ACI0106035 インデックス再構築中に表示される進捗ダイアログのメッセージが1行に収まらず，判読できないことがありました。

* ACI0106006 [`restrictedByDefault`](https://developer.4d.com/docs/ja/ORDA/privileges#restriction-modes)が`True`の場合，*Authentify* で権限を取得した後も計算属性にアクセスできず，`restrict`フィルターも適用されませんでした。

* ACI0106005 無効なシンタックスですが，空の`Try()`構文をコンパイルした場合，`GFLAGS`でメモリ破壊が検出されました。

* ACI0105906 WebSocketサーバーは`1`件のメッセージバンドル毎に1回しかワーカーをトリガーしませんでした。同時に`n+x`件のメッセージがキューに追加されても，`n+1`件しかワーカーのスタックが増えないため，最新のメッセージではなく，数分前に送信したメッセージが処理されることがありました。

* ACI0105672 ライセンスを指定せずに*Build4D* でサーバーアプリケーションをビルドすることができませんでした。

* ACI0106011 [`restrictedByDefault`](https://developer.4d.com/docs/ja/ORDA/privileges#restriction-modes)が`True`の場合，*Authentify* で権限を取得した後もエイリアス属性にアクセスできませんでした。

* ACI0106003 OEM Desktopライセンスをアクティベーションすることができませんでした。ライセンス登録サーバー側でマスタープロダクト（Developer Professional）とのリンク処理がうまくできてないようです。

* ACI0105904 プロジェクトモードのみ。ビルドしたアプリケーションのログイン画面で「パスワードを保存」を有効にしても，パスワード（のハッシュ）が保存されず，毎回，入力を求められました。

**注記**: ログイン情報は*AppData/Roaming* またはApplication Supportフォルダーに「アプリケーション名.mdp」というファイル名で保存されます。ログイン画面を再表示されるためには，起動時にShiftキーを押しつづけてください。

* ACI0105991 インデックスが設定されている`4D.Vector`型のフィールドに対してクエリを実行した場合，空のエンティティセレクションが返されました。

* ACI0106048 フランス語版のみ。ヌルポインターを逆参照しようとした場合に返されるエラーメッセージのXLIFFリソースがありませんでした。

* ACI0106033 SVGコンポーネントの`SVG_New_textArea`に渡されたテキストのアンパーサンド記号（`&`）が正しくエンコードされませんでした。

* ACI0106015 *4D Widgets* コンポーネントがロードされていない場合，フォームエディターのオブジェクトライブラリに無効な項目が表示されました。使用されていない依存関係はオブジェクトライブラリから除外されるべきです。

* ACI0105956 コンポーネントの*HTTPHandlers.json* ファイルでHTTPハンドラーを定義し，ホストのWebサーバーに対して合致するリクエストを送信した場合，コンポーネントのHTTPハンドラーが呼ばれませんでした。

**注記**: コンポーネントの*HTTPHandlers.json* ファイルでHTTPハンドラーを定義する場合，コンポーネントのクラス名前空間を含める必要があります。また，コンポーネント側でホストの`WebServer`オブジェクトを使用するためには*On before host database startup* データベースメソッドでオブジェクトにアクセスする必要があります。

```4d
#DECLARE($event : Integer)

Case of 
	: ($event=On before host database startup)
		var $webServer : Object
		$webServer:=WEB Server(Web server database)
End case 
```

* ACI0106042 共有オブジェクトグループのコピー中にアクセス競合が発生する恐れがありました。

* ACI0106007 特定の状況で`WEB SEND RAW DATA`を実行した場合，アプリケーションがクラッシュしました。

ACI0106044	AST interpreter: dereferencing a null 4D pointer does not trigger an error		4D Staff	According to origin

* ACI0106043 HTTPリクエストハンドラーの`IncomingMessage`オブジェクトの`urlQuery`プロパティの値に含まれる`%3D`が`=`にデコードされました。

* ACI0106040 macOS 26.1 Apple Silicon版のみ。4D Write Proエリアに対して擬似的にキーボードイベントを発生させた場合，アプリケーションがクラッシュする恐れがありました。

* ACI0106023 `SMTPTransporter`でメールを送信した場合，メール本文中に含まれるピリオド記号（`.`）が失わることがありました。ACI0105850が修正されたことによる副作用のようです。

* ACI0105929 Mac版のみ。`entitySelection.slice()`で作成したエンティティセレクションに対し，オブジェクト型フィールドの並び替えを属性パスを指定せずに実行した場合，アプリケーションがクラッシュすることがありました。 

* ACI0105920 デザインモードのウィンドウ（ツールボックスやエクスプローラーなど）をフルスクリーン表示している状態でプロジェクト依存関係を表示した場合，依存関係マネージャーのウィンドウが正しく表示されませんでした。

* ACI0106009 コンポーネント依存関係のサーバー側で設定した場合，コンポーネントがサーバー側ではロードされますが，クライアント側ではロードされませんでした。

* ACI0105982 リモートデバッガに引数の値が正しく表示されませんでした。WebSocketの`remoteDebugger`パケットをトレースすると，`nakedValue`が空であり，JSON文字列が正しくエスケープされてないことが確認できます。

* ACI0105917 Windows版のみ。View Proスプレッドシートのピボットテーブルにフィールドをドラッグ＆ドロップすることができませんでした。

* ACI0105999 Windows版Fluent UIモードのみ。に`ftp`から始まるURLをWebエリアにロードしようとした場合，アプリケーションがクラッシュしました。

* ACI0105998 Windows版Fluent UIモードのみ。WebエリアのURLプロパティが無視されました。

* ACI0105993 「4D Serverへの接続」画面に「最近使用」のリストが表示されませんでした。

* ACI0105988 コンボボックスまたはポップアップメニューのデータソースにオブジェクト型を使用し，`values`プロパティにクラスの計算属性を使用した場合，「ランゲージコンテキストが不足」しているというエラーが返されました。

* ACI0105965 Windows版Fluent UIモードのみ。クリックしたデフォルトボタンがフォーカス表示されませんでした。

* ACI0105961 エクスプローラーで選択したフォーム・メソッド・クラスを`Return`キーで開くことができませんでした。

* ACI0105942 Windows版のみ。[`WA SET PREFERENCE`](https://developer.4d.com/docs/ja/commands/wa-set-preference)で*WA enable Web inspector* を`False`に設定しても，コンテキストメニューに「開発者ツールで調査する」メニューが表示されました。

* ACI0105967 QUICネットワークレイヤー（`ngtcp2`）のみ。クライアント/サーバーのネットワーク接続が切り替わった後も`Session.info.IPAddress`は古いIPアドレスのままでした。

* ACI0105877 エクスプローラーで複製したクラスをごみ箱に移動してから再び複製した場合，複製したクラスとごみ箱にあったクラスの両方が「ホーム」タブに表示されました。

* ACI0105909 `Choose`に整数型のプロパティを渡した場合，コンパイルエラーになりました。

* ACI0105886 Mac版クライアント/サーバー版のみ。QUICネットワークレイヤーがクラッシュすることがありました。

* ACI0105975 「アプリケーションについて」画面のリンク（法的な情報・著作権・世界の4D）が間違っていました。ホームページではなく，[世界中の4D](https://jp.4d.com/4d-around-the-world)にジャンプするべきです。

* ACI0105765 コンパイルモードのみ。Webプロセスのコンテキストで`#DECLARE`で宣言されたプロジェクトメソッドのパラメーターに値を渡さず，そのパラメーターに値を代入しようとした場合，エラーが返されました。本来，[渡されなかった引数にアクセスすることは可能](https://blog.4d.com/ja/stop-press-accessing-parameters-not-being-passed-is-possible/)なはずです。

**注記**: メソッドの呼び出しから任意パラメーターの型を推定するコードでは，コンパイルの順序により，シンタックスチェックが任意パラメーターの存在を見落とすことがありました。問題は修正されましたが，再コンパイルが必要です。

* ACI0105864 リストボックスのセルを編集中にアプリケーションを背面に移動した場合，点滅カーソルのアニメーションが停止しませんでした。テキスト入力やコンボボックスは問題ありません。

* ACI0105762 `VP Get table range`から返されたレンジオブジェクトを`VP RESIZE TABLE`に渡すことができませんでした。

* ACI0105955 コンポーネントをビルドした場合，Appleの公証に必要な`CFBundlePackageType`キー（値: `BNDL`）が*Info.plist* ファイルに書き込まれませんでした。

**注記**: アプリケーション本体のビルドコマンドに加え，*Build4D* コンポーネントも[修正](https://github.com/4d/Build4D/commit/29d30e312e04302f2ba4c2141025f0778536bad2)されました。

* ACI0105950 Mac版のみ。フローティングウィンドウでランタイムエクスプローラーを開いた場合，プロセスページに情報が表示されませんでした。

* ACI0105928 *NetKit* コンポーネント`state`プロパティに拡張文字が含まれる場合，`NetKit.OAuth2Provider.getToken()`が`404`エラーを返ししました。

* ACI0105820 強制ログインモードを有効にした場合，4D Mobileを利用することができませんでした。

* ACI0105947 macOS 26 Tahoeのみ。ウィンドウのタイトルバーにLTSではなくフィーチャーリリースのアイコンが表示されました。

* ACI0105951 macOS 26 Tahoeのみ。「サーバーに接続」「シンタックスエラー」などのウィンドウに表示されるアイコンがバージョン`21`のものではありませんでした。

* ACI0105953 Windows版のみ。ODBCドライバーのインストーラーのアイコン画像がバージョン`21`のものではありあませんでした。

* ACI0105938 クライアント/サーバー版のみ。コンパイルモードでランタイムエクスプローラーを表示したままクライアントを終了しようとした場合，アプリケーションがフリーズしました。

* ACI0105936 アプリケーションビルド画面にライセンスを追加した場合，ビルド自体は成功しますが，追加したライセンスがリストに表示されませんでした。

* ACI0105882 タイムアウトを変えて`4D.HTTPRequest`の`wait()`メソッドを実行した場合，進行中のリクエストがアボートされました。

* ACI0105932 フォームオブジェクトの標準アクションをコンテキストメニューで変更し，他に何も変更しなかった場合，更新が保存されませんでした。

* ACI0105845 クライアント/サーバー版のみ。`entitySelection.orderByFormula()`でエンティティセレクションをフォーミュラに使用した場合（例: `This.indexOf(entitySelection)`），エラーが返されました。

**注記**: クライアント側のエンティティセレクションをクエリのフォーミュラに使用することはできません。修正により，エラーメッセージの内容が見直されました。

* ACI0105946 ASTインタープリターモードでは，コンパイル済みコンポーネントメソッドに対して`Call chain`を使用した場合，正しい呼び出し連鎖が返されないことがありました。

* ACI0105891 QUICネットワークレイヤー（`ngtcp2`）のみ。クライアント/サーバー版のみ。データベースパラメーターの`Remote connection sleep timeout (98)`を設定したクライアントのシステムがスリープモードに移行した場合，アプリケーションがクラッシュしました。QUICネットワークレイヤー（`lsquic`）では問題ありません。

* ACI0105944 ASTインタープリターモードでは，`Call chain`から`formula`プロパティが返されないことがありました。

* ACI0105850 メールに特定の文字が含まれる場合，[`MAIL Convert to MIME`](https://developer.4d.com/docs/ja/commands/mail-convert-to-mime)または[`MAIL Convert from MIME`](https://developer.4d.com/docs/ja/commands/mail-convert-from-mime)で本文を正しく変換できないことがありました。

* ACI0105891 QUICネットワークレイヤー（`ngtcp2`）のみ。クライアント/サーバー版のみ。データベースパラメーターの`Remote connection sleep timeout (98)`を設定したクライアントのシステムがスリープモードに移行した場合，アプリケーションがクラッシュしました。QUICネットワークレイヤー（`lsquic`）では問題ありません。

* ACI0105916 `JSON Validate`のコレクション型を渡すことができませんでした。

**注記**: コマンドのシンタックスが見直されました。

* ACI0105901 エクスプローラーでテーブルを選択した場合，すぐにプレビューが表示されませんでした。エクスプローラーのウィンドウを背面に移動してから再び最前面に移動すれば，プレビューが表示されます。

* ACI0105912 Windows版のみ。WinUIアピアランスのリストボックスが配置されたフォームを表示した場合，アプリケーションがクラッシュすることがありました。

* ACI0105908 `Choose`コマンドの引数としてクラスのプロパティを記述した場合，メソッドエディターのヘルプTipsに間違った型が表示されました。

* ACI0105911 同一セッションの複数プロセスから同時にユーザー＆グループにアクセスした場合，アプリケーションがクラッシュする恐れがありました。

* ACI0105921 コンポーネントがインストールされていない新規プロジェクトにGitHubコンポーネントを追加した場合，コンポーネントはダウンロードされますが，依存関係マネージャーの画面が閉じられませんでした。*lock.dependencies* が存在しない場合に問題が発生するようです。 

* ACI0105930 クライアント/サーバー版バイナリモードのみ。新規メソッドを作成しようとした場合，アプリケーションがクラッシュすることがありました。

* ACI0105923 クエリエディターを閉じてから再表示した場合，ランタイムエラーが返されました。

* ACI0105478 [`SET DATABASE PARAMETER`](https://developer.4d.com/docs/ja/commands/set-database-parameter)のセレクター`34`（デバッグログ）の「即時記録」モードを有効化した場合，二重にエントリーが記録されました。

**注記**: 遅延記録モードでコマンドのパラメーターが二重に出力される不具合が修正されました。
二重に記録されているようにみえること自体は不具合ではありません。即時記録モードは，クラッシュ等の原因を調査するために使用されることが想定されており，オペレーションの前後にコマンド名が記録されるように設計されています。一方，遅延記録モードはパフォーマンスの最適化を図るために使用されることが想定されており，オペレーションの回数を確認したり，ベンチマーク統計のために使用されることが想定されています。