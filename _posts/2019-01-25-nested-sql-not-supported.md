---
layout: post
title: "Begin SQL/End SQLがスレッドセーフに"
date: 2019-01-25 16:39:43
categories: リリースノート 
tags: 17r4 sql orda  
version: 17r4  
---

現在ベータ公開中の17r4では，[Begin SQL](https://doc.4d.com/4Dv17R4/4D/17-R4/Begin-SQL.301-4054985.ja.html)/[End SQL](https://doc.4d.com/4Dv17R4/4D/17-R4/End-SQL.301-4054986.ja.html)がプリエンプティブモードをサポートするようになりました。

4DのSQLサーバーは，v11からスレッドセーフ（マルチコア対応）であり，以前から個別のリクエストをCPUコアに分散して処理できる設計でした。今回，コマンドがアップデートされたのは，最小限の書き換えでBegin SQL/End SQLが記述された既存コードをプリエンプティブモードで実行できるようにするためです。SQL言語の使用を促進するためではありません。

カレントレコードやカレントセレクションを変更せずにテーブルをルックアップする目的でSQLを使用しているデベロッパーは少なくありません。今回のアップデートにより，メソッドをスレッドセーフにするため，そのような処理を[ORDA](https://doc.4d.com/4Dv17R4/4D/17-R4/Overview.200-4085814.ja.html)に書き換える必要がなくなりました。もちろん，今後の開発では，SQLではなく，ORDAを使用することが推奨されています。

データベースにアクセスするため，必要であれば，SQL言語を使用することができます。しかし，4Dが力を注いでいるのは，ORDAのほうであり，SQLは互換性のためにサポートされている，ということに留意してください。たとえば，SQLのネストはサポートされていないため，トリガにSQLが記述されたテーブルにSQLでアクセスすると，エラーが返されます。この制限が取り払われる予定はありません。トリガで，カレントレコードやカレントセレクションを変更せずにテーブルをルックアップしたいのであれば，SQLではなく，是非，ORDAを使用してください。
