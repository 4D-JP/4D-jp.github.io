---
layout: post
title: "View Proコピーペーストの処理速度"
date: 2022-11-29 12:00:00
categories: 仕様
tags: viewpro 19r4
---

SpreadJSは，Microsoft Excelのようなウィンドウ間のスプレッドシート参照をサポートしてません。たとえば，スプレッドシートからカットまたはコピーしたデータを別のスプレッドシートにペーストした場合，セルの属性やフォーミュラが完全には転写されませんでした。

19r4では，View Proエリア間のコピー/ペーストをサポートするため，独自のテクニックが実装されていました。具体的には，非表示のシートをスプレッドシートの最後に追加し，そこに擬似的なペーストをした後，シート全体をバイナリ形式でペーストボードに登録していました。ペーストのときはこのデータから非表示のシートを再現し，擬似的なコピーが実行されるようになっています。コピー/ペーストのたびにシート全体を複製するため，速度が低下しますが，純正のSpreadJSよりも高度なコピー/ペーストを実現していました。

19r5では，SpreadJSのアップデートにより，この回避策が使用できなくなったので，この仕組みも取り除かれています。r4のように高度なコピー/ペーストはできなくなりましたが，代わりにコピー/ペーストの処理速度が本来のものに戻りました。
