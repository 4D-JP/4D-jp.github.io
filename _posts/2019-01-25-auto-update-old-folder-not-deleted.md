---
layout: post
title: "サービス起動したサーバーの自動アップデートで一時フォルダーが削除されない場合"
date: 2019-01-25 16:39:43
categories: 仕様 
tags: windows server 
version: 16.x
---

Windows版の4D Serverは，[サービスとして登録する](https://doc.4d.com/4Dv17/4D/17/Registering-a-Database-as-a-Service.300-3743260.ja.html)ことができます。

サービスのプロパティで，「ログイン」で管理者権限のあるアカウントを設定し，アプリケーションが自動的に起動するようにサービスを設定すれば，コンピューターにユーザーが誰もログインしていなくても，4D Serverが起動するようになります。

そのようなサーバーを[自動アップデート](https://doc.4d.com/4Dv17/4D/17/Automatic-updating-of-server-or-single-user-applications.300-3743569.ja.html)を実行した場合，アップデートの入れ替えには成功しますが，以前のバージョンが``~app~_old0001``のような名前の一時的なフォルダーにそのまま残された状態になります。これは仕様です。

自動アップデートの仕組みは，内部的に「ごみ箱に移動」コマンドを実行しています。アップデートを取り消したい場合，以前のバージョンにアプリケーションを戻すことができるようにするためです。この操作は，ログインユーザーのセッションが必要なハイレベルコマンドであるため，条件によっては失敗することがあります。「ごみ箱に移動」コマンドが完了できなかった場合，エラーコードの``1018 (PW32)``および``661 (xbox)``がアップデーターのログファイルに記録されます。
