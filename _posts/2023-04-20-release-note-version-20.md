---
layout: fix
title: "4D v20 修正リスト"
date: 2023-05-29 08:00:00
categories: 修正リスト
tags: v20 
build: 100361
version: "20"
permalink: /2023/110/:slug/
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}} 

* ACI0103951 プロジェクトモードのみ。通常スタイル以外のボタンをデフォルトボタンに設定した場合，スタイルが無視されて通常スタイルになりました。

* ACI0103938 Mac版のみ。アイコンのないツールバースタイルのボタンにポップアップメニューを設定した場合，メニューアイコンが表示されませんでした。
 
* ACI0103963 ボタンの「ポップアップメニュー」プロパティを変更した場合，*On Alternative Click* イベントがプロパティリストに表示されませんでした。

* ACI0103962 ベベルボタンの水平揃えを「左」，タイトル/ピクチャの位置を「中央」に設定した場合，垂直揃えが正しくありませんでした。

* ACI0103954 Windows版のみ。PDF形式でWrite Proドキュメントをエクスポートした場合，Wingdingsフォントが表示されませんでした。
 
* ACI0103937 Office XPスタイルのボタンにポップアップメニューを設定した場合，メニューアイコンが表示されませんでした。

* ACI0103902 Windows版のみ。ウィンドウタイプ`8`の動作が以前のバージョンとは違いました。このタイプのウィンドウを表示している間は他のウィンドウに切り替えることができないはずです。

* ACI0103949 Windows版プロジェクトモードのみ。ボタンにフォーカスが表示されませんでした。

* ACI0103946 配列型のリストボックスのプロパティを`LISTBOX SET PROPERTY `と`lk auto row height`で変更した場合，行の高さが正しく計算されませんでした。

* ACI0103935 `Get current printer`を使用せずに`QR BLOB TO REPORT`を実行した場合，アプリケーションがクラッシュしました。

* ACI0103934 テキストをタイプ入力した直後など，文字列がハイライト選択されていない状態でスタイル付きテキストにボールドなどのスタイルを何度も設定した場合，テキストに新しいスタイルが適用されませんでした。

* ACI0103925 Write Proドキュメントに`WP INSERT FORMULA`でローカル変数を参照する`WP Get page count`をフォーミュラとして挿入した場合，`WP PRINT`がクラッシュしました。

**注記**: 修正により，クラッシュは発生しなくなりましたが，Write Proエリアをローカル変数に代入してフォーミュラ内から自己参照することはできません（空の値が返されるだけです）。`WP Get page count`はページレイアウトを再計算するため，このコマンドをWrite Proドキュメントにフォーミュラとして埋め込んだ場合，再帰的な呼び出しになります。あらかじめページカウントを計算するか，`This.pageCount`を使用してください。

* ACI0103948 ビルド版サーバーの *On Server Startup* データベースメソッドでワーカーを起動して`ds`を使用した場合，アプリケーションがクラッシュしました。

* ACI0103929 テーブル名を途中まで入力して`tab`キーを入力した場合，入力中の文字列に関係なく，並び順がもっとも上位のテーブル名が挿入されました。候補が`1`個に絞り込まれるまでテーブル名を入力する必要がありました。

* ACI0103924 クライアント/サーバー通信の暗号化を有効にしており，起動時にWebサーバーを起動するように設定した場合，HTTPSサーバーが正しい証明書チェーンを使用しませんでした。

* ACI0103886 特定のメールを`MAIL Convert from MIME`でメールオブジェクトに変換した場合，`bodyValues`プロパティが返されませんでした。

* ACI0103834 ストラクチャエディターの検索ツールの消去アイコンをクリックした場合，検索文字列はクリアされますが，入力エリアの背景色がリセットされませんでした。
 
* ACI0103919 自動行高さが設定されたエンティティセレクション型のリストボックスにエンティティを追加した場合，追加した行の高さが`0`となり，正しく再描画されませんでした。既存のセルを長い内容で更新した場合も同じような問題が発生します。

* ACI0103933 Mac版のみ。*iODBC Framework* がインストールされていない状態で`SQL GET DATA SOURCE LIST`を実行した場合，内部エラー（サイズが`Null`の配列）が返されました。

* ACI0103898 配列型リストボックスの行を移動した場合，*On Row Moved* だけでなく *On Clicked* イベントが発生しました。

**注記**: 「行の移動可」プロパティが有効にされている場合，マウスボタンをリリースしたタイミングでクリックまたはドロップ（行の移動）イベントが発生します。有効にされていない場合，マウスボタンを押したタイミングでクリックイベントが発生します。

* ACI0103688 PHPスクリプトから4DのWebSocketサーバーに続けて同じテキストファイルを送信した場合，パケットが届きませんでした。 

* ACI0103910 メソッドエディターで *tab* キーを使用し，コード補完で既出の変数名を入力した場合，大文字と小文字の違いが是正されませんでした。

* ACI0103907 メソッドエディターで`var`キーワードに続けて *tab* キーを使用し，コード補完で既出の変数名を挿入することができませんでした。宣言文が入力の途中（コロン記号と変数タイプが未入力）であれば問題ありません。

* ACI0103836 Mac版のみ。`collection.orderByMethod()`でコールされた並び替えメソッドの中で条件`$1.value<$1.value2`が`False`のときに`$1.result`に`True`を代入した場合，アプリケーションがクラッシュしました。Windowsではクラッシュしませんが，フォーミュラの戻り値に`False`が返されました。

**注記**: 並び替えのロジックが内部的に矛盾している場合，エラー`917`が返されるようになりました。

* ACI0103692 `Super()`のヘルプTipsがローカライズされていませんでした。

* ACI0103909 メソッドエディターに`#DEC`と入力し，*tab* キーを使用した場合，コード補完が正しく機能しませんでした。入力した文字列が`#DE`または`#DECL`であれば，`#DECLARE`と補完されます。
 
* ACI0102400 フォームオブジェクトの数式に`collection[0]`のようなコレクション要素の参照を記述した場合，値を代入することができませんでした。

* ACI0103908 メソッドエディターに数値リテラルを入力し，ピリオド記号に続けて *tab* キーを使用した場合，コード補完の候補としてマクロのリストが表示されました。

* ACI0103832 Mac版のみ。[freeTDS](https://www.freetds.org/)のODBCドライバーで4DからSybaseに接続することができませんでした。macOS Ventura 13.3.1アップデート前は問題ありませんでした。

* ACI0103784 フォームに埋め込まれたクイックレポートエディターで`QR SET SELECTION`を使用した場合，選択した列がエディターの表示に反映されませんでした。

* ACI0102039 メソッドエディターでトークナイズされたプロジェクトメソッドを部分的にハイライト選択した状態で検索を実行した場合，選択された文字列ではなく，メソッド名の全体が検索文字列となりました。コメント文やリテラル文字列と同じようにハイライト選択された文字列が検索文字列になるべきです。
 
* ACI0103923 Windows版のみ。SDIモードでビルドしたアプリケーションが起動後にデスクトップの最前面へ移動しませんでした。最前面でないことは，ウィンドウタイトルがグレーアウトされていることからわかります。ACI0103858が修正されたことによる副作用のようです。

* ACI0103922 Windows版のみ。サーバー側の *4D Progress* コンポーネントがコンパイルされていませんでした。ソースファイルや *git* 管理ファイルがそのままビルドに含まれています。

* ACI0103913 [短絡演算子](https://developer.4d.com/docs/ja/Concepts/operators/#短絡演算子)の`&&`や`||`とオブジェクトリテラルの`{}`を併用した場合，シンタックスエラーになりました。

* ACI0103810 Mac版のみ。サーバーにクライアントが接続した状態で`QUIT 4D(0)`を実行した場合，サーバーがクラッシュしました。旧式ネットワークレイヤーでは問題ありません。

* ACI0103912 プロジェクトモードのみ。フォントサイズを`11`以下に設定した場合，垂直中央揃えテキストのベースラインが若干高くなりました。

* ACI0103901 Mac版のみ。複製したSVGピクチャを含むWrite Proドキュメントを`WP EXPORT DOCUMENT`でPDFに変換しようとした場合，アプリケーションがクラッシュしました。Windowsではクラッシュしませんが，SVG画像がラスタライスされました。

* ACI0103889 フォームエディターからツールボックスを開いた場合，編集中の *.4DForm* が保存されました。メソッドやフォームのソースファイルは，エディターではなく，アプリケーションを非アクティブにしたタイミングで保存されるべきです。
 
* ACI0103900 v20で追加された`collection.first()`がシンタックスチェックで不明なメンバー関数として警告表示されました。

* ACI0103874 メソッドエディターで`QUERY`コマンドのパラメーターとして`[`記号を入力せずに文字列をタイプした場合，テーブル名が候補として表示されませんでした。

* ACI0103790 Windows版のみ。`Begin SQL`~`End SQL`ブロックに日本語のローカル変数名を記述した場合，コンパイルエラーが返されました。

```4d
$引数:="abc"
$変数:=0

Begin SQL
    SELECT ID FROM Table_1 WHERE Field_2 = :[$引数] INTO :[$変数];
End SQL
```

* ACI0103879 メソッドエディターにオブジェクト型の変数に続けてピリオドとアンダースコアを入力し，*tab* キーを使用した場合，アンダースコアから始まる属性名が候補として表示されませんでした。

**注記**: アンダースコアから始まる属性名や関数名は暗黙的に非公開（プライペート）とみなされ，タイプアヘッドの候補リストに表示されない仕様となっています。これはタイプアヘッド機構の命名規則に過ぎず，アンダースコアから始まる属性名や関数名の参照が禁止されているわけではないので，v19と同様にアンダースコア記号を入力すればタイプアヘッド入力ができるように動作が調整されました。

* ACI0103878 `4D.HTTPRequest`の`certificatesFolder`に渡した証明書が無視されました。

* ACI0103676 Windows版のみ。複数の4D Serverをローカルアカウントでサービス起動した場合，`Get license info`が正しい接続クライアント数を返しませんでした。

* ACI0103782 アプリケーションビルド画面の「アプリケーション名」入力エリアの幅が十分ではありませんでした。

* ACI0103817 英語版のみ。データベース設定画面のヘルプボタンをクリックした場合，ドキュメントサイトの該当ページにジャンプするはずですが，英語版のページは言語識別子（`/en/`）を省略する必要があるため，ページが開きませんでした。

* ACI0103888 Windows版のみ。Windows Server 2012 R2またはWindows Server 2016でアプリケーションを起動した場合，エントリーポイント`SetThreadDescription`がみつからない，というエラーが返されました。Windows Server 2019以降であれば問題ありません。

* ACI0103881 ストラクチャエディターでズーム操作をしようとした場合，初回だけエラーが返されました。

* ACI0103882 エクスプローラーのテーブルタブで右側に表示されるフィールドリストのヘッダーをクリックした場合，並び替えが実行されませんでした。

* ACI0103880 フォームエディターでピクチャボタンを選択し，ツールボックスを起動してヘルプTipsを変更した後，フォームエディターを最前面に移動した場合，プロパティリストに表示されるヘルプTipsのポップアップメニューが更新されませんでした。ピクチャボタン以外のフォームオブジェクトを選択してから。ピクチャボタンを再選択すれば，プロパティリストの内容が更新されます。

* ACI0103877 Mac版のみ。QUICネットワークレイヤーが有効にされている場合，ビルド版のクライアントからビルド版のサーバーに接続することができませんでした。

* ACI0103866 テーブル間に同名のリレーションが定義されているデータベースにクライアントを接続した場合，アプリケーションがクラッシュしました。

* ACI0103865 ORDAクエリに`88`個のパラメーターを渡した場合，アプリケーションがクラッシュしました。

* ACI0103763 デバッガに共有オブジェクトの共有ステータスが表示されませんでした。共有コレクションは問題ありません。
 
* ACI0103863 *On Startup* データーベースメソッドで更新したメニュー項目がアプリケーションモードで表示されませんでした。

* ACI0103776 Mac版のみ。`command`+`#`というキーボードショートカットをコマンドで設定した場合，メニュー項目にショートカットが`⇧⌘3`と表示されました。

* ACI0103839 データソースに変数ではなくフォーミュラが設定されたWrite Proエリアにウィジェットまたはツールバーを使用してドキュメントをインポートしようとした場合，エラーが返されました。
 
* ACI0103846 QUICネットワークレイヤーのみ。サーバー管理画面にアプリケーションプロセスのタイプが「アプリケーションサーバー」と表示されました。「4Dクライアントプロセス」と表示されるべきです。タイプが違うため，プロセスのアボートやユーザーのウォッチができません。

* ACI0103800 サーバー管理画面に複数のアップデータープロセスが表示されることがありました。そのうち一方はアボートすることができません。

* ACI0103774 Write Proのテーブルでバリアント型を扱うことができませんでした。一旦，ピクチャ型を表示すると，その列にはテキストなどの値を表示することができませんでした。

* ACI0103862 デザインモードのツールバーまたはファイルメニューから新規プロジェクトを作成することができませんでした。

* ACI0103858 Windows版のみ。SDIモードで「ウィンドウの位置とサイズを保存」オプションを指定して`Open form window`を実行した場合，ウィンドウの位置とサイズが保存されませんでした。

* ACI0103857 クイックレポートの印刷プレビューができませんでした。

* ACI0103787 テキストを選択した状態で`FILTER KEYSTROKE("")`を実行した場合，選択したテキストが空の文字列で置換されることにより，消去されました。

* ACI0103716 コレクション型またはエンティティセレクション型のリストボックスでは，`control`+`Z` による入力の取り消しができませんでした。配列型のリストボックスであれば問題ありません。編集メニューの項目プロパティ「イベントを発生させない」を有効にするか，`SET MENU ITEM PROPERTY`で`"4D_execute_without_validating"`を`True`に設定すれば問題ありません。

* ACI0103850 Mac版のみ。3Dラジオボタンをプロジェクトに変換した場合，アプリケーションモードではボタンの代わりにラジオボタンが表示されました。

* ACI0103821 「プッシュボタン」スタイルの3Dチェックボックスまたは3Dラジオボタンをプロジェクトに変換した場合，ベベルボタンではなく，チェックボックスまたはラジオボタンが表示されました。

* ACI0103831 メソッドエディターでプロセス変数名およびインタープロセス変数名のタイプアヘッドが機能しませんでした。

* ACI0103732 `SET DATABASE PARAMETER`で *4D Remote mode timeout* を変更した場合，`WEB GET OPTION`で設定した *Web Client IP address to listen* がリセットされました。

**注記**: コマンドで待ち受けポート番号を変更した場合，新しい設定はメモリに置かれ，*settings.4DSettings* ファイルは更新されません。`SET DATABASE PARAMETER`で *settings.4DSettings* ファイルを更新した場合，リロードされたファイルでメモリ上の設定が上書きされてしまうことが問題でした。

* ACI0103825 サーバー終了時に多数のプロセスが遅延されていた場合，アプリケーションがすぐには終了しませんでした。遅延中のプロセスを強制的に終了するまでのタイムアウトが`3`秒ではなく`50`秒に設定されていたため，プロセスが強制的に終了させられるよりも早く"Task Pending"アラートが表示されました。

**注記**: 問題は修正されましたが，修正前のバージョンでも，何もしていないプロセスが終了を阻んでいるだけだったので，たとえ強制的にサーバーを終了してもデータファイルに破損が生じる恐れはありません。

* ACI0103804 クライアント/サーバー版のみ。サーバー管理画面が表示されている状態で`RESTART 4D`を実行し，管理画面の表示を切り替えた場合，サーバー管理画面を閉じるまでサーバーの再起動がブロックされました。

* ACI0103477 View Proスプレッドシートでテーマが設定されたテーブルをリサイズした場合，列のテーマが隣接する列に適用されました。

**注記**:  SpreadJS v16.0で問題が修正されました。

* ACI0103821 「プッシュボタン」スタイルの3Dチェックボックスまたは3Dラジオボタンをプロジェクトに変換した場合，ベベルボタンではなく，チェックボックスまたはラジオボタンが表示されました。

* ACI0103809 プロパティリストで入力不可に設定されているフィールドを`OBJECT SET ENTERABLE`で入力可に設定した場合，フィールドに関連付けられた選択リストのドロップダウンメニューが表示されませんでした。プロパティリストで入力可に設定されているフィールドを *On Load* イベントで入力不可に設定しておき，それを後から入力可に切り替えた場合は問題ありません。

* ACI0103827 新ネットワークレイヤーのみ。サーバーの管理画面で新規クライアント接続を拒否した場合，操作をする前から接続していたクライアントもサーバーと通信できなくなりました。

* ACI0103830 Windows版のみ。データベース設定で開始モードが「アプリケーション」に設定されており，標準アクションの「デザインモード」が関連づけられたメニューやオブジェクトが存在せず，SDIモードが有効にされている場合，デザインモードに移動する手段がなくなりました。SDIモードでは*Alt*+*Shfit*+右クリックを入力しても[プロセスメニュー](https://doc.4d.com/4Dv19/4D/19.6/Debugger.300-6269364.ja.html)が表示されないためです。

* ACI0103780 無効なSVGをフォームに表示しようとした場合，不明なエラー`1`が返されました。レンダリングできないSVG画像は代わりに×マークが表示されるべきです。たとえば`link:href`属性に無効なデータURIが記述されている場合に問題が生じました。
    
* ACI0102338 冒頭にブロックコメントが記述されている行で変数名またはメソッド名を名称変更した場合，冒頭のブロックコメントがコメント行に変わり，結果として行全体がコメント文になってしまいました。

* ACI0103820 クライアント/サーバー版のみ。元サイズが`0`ではない`4D.Blob`属性をサイズが`0`の`4D.Blob`で更新することができませんでした。

* ACI0103814 クライアント/サーバー版のみ。元サイズよりも小さなサイズの`4D.Blob`属性を`dk auto merge`モードで更新することができませんでした。

* ACI0103796 Mac版のみ。macOS Venturaでボタンタイトルに自動スタイルシート以外のフォントを指定した場合，タイトルが中央よりも少し上に表示されました。

* ACI0103147 クライアント/サーバー版のみ。クライアントの「サーバーに接続」画面にブラケット記号とポート番号を省略してIPv6アドレスを入力した場合，サーバーに接続することができませんでした。

* ACI0103758 リストボックスを垂直方向にリサイズした場合，*On Display Detail* イベントが過剰に発生しました。

* ACI0103725 リストボックスを垂直方向にリサイズした場合，出現した行で追加の*On Display Detail* イベントが発生せず，リストボックスが完全に再描画されませんでした。垂直スクロールバーを操作してリストボックスを再描画すれば，出現した行の内容が表示されます。

* ACI0103829 コンテキストメニューの「定義に移動…」でプロジェクトメソッドを開くことができなくなりました。メソッドメニューの「定義に移動…」は問題ありません。

* ACI0103554 サービス起動した4D Serverをタスクマネージャーで再起動できないことがありました。CEFをビルドから除外すれば問題ありません。

* ACI0101476 起動時に重複キーが検出された場合，アラートがサーバー管理画面の背後に表示されました。管データファイルのチェックが完了する前に理画面が表示されるためです。

* ACI0103848 配列型リストボックスのセルに関連づけられたポップアップ/ドロップダウンメニューの項目をキーボード操作で選択した場合，*On Data Change* イベントが発生しませんでした。

* ACI0103842 View Proスプレッドシートのピボットテーブルスライサーおよびタイムラインスライサーが正常に動作しませんでした。JavaScriptファイルをロードする順序が正しくないようです。

* ACI0103808 リストボックスに自動行高さ・垂直パディング・最大行数が設定されており，最大行数未満のセルが存在する場合，一部のセルは内容が途切れて表示されました。

* ACI0103798 [`collection.reduce()`](https://developer.4d.com/docs/ja/API/CollectionClass/)の判定を`$1.stop`で終了することができませんでした。

* ACI0103709 プロジェクトモードのみ。フォームエディターのプロパティリスト入力項目を *tab* キーで移動することができませんでした。
