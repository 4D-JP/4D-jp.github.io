---
layout: fix
title: "4D v17 修正リスト"
date: 2019-10-25 08:00:00
categories: 修正リスト
tags: "18.0"  
build: 243653
version: 18.0

---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}}  

* ACI0099736 クライアント/サーバー版のみ。ORDAの``entity.drop()``が``dk force drop if stamp changed``モードで成功しなかった場合，返されるステータスオブジェクトの``success``に``True``が返されました。

* ACI0099730 リストボックスの「カラム自動リサイズ」および「スクロールしない列」を併用した場合，カラムのリサイズが不自然になりました。ウィンドウのリサイズあるいはヘッダーセパレーターのドラッグ＆ドロップで問題が発生します。

* ACI0099725 プロジェクトモードでフォームを開いた場合，「オブジェクト名」「タイトル」「メソッド」プロパティの入力中に``delete``キーを入力すると，入力がキャンセルされてキャレットが消えました。

* ACI0099723 Mac日本語版のみ。選択されたテキスト範囲の日本語フォントがWrite Proツールバーに認識されませんでした。英語フォント，あるいはシステム環境設定で言語が英語に設定されたMacであれば問題ありません。

* ACI0099719 クライアント/サーバー版のみ。エンティティに対応するレコードを従来のランゲージで更新した場合，``entity.reload()``を実行してもエンティティが最新の値に更新されませんでした。

* ACI0099718 クライアント/サーバー版のみ。エンティティのリレーション属性を更新して``entity.save()``を実行した場合，値が``undefined``になってしまい，``entity.reload()``でもエンティティのリレーション属性をリロードすることができませんでした。

* ACI0099711 4D Serverに大量のWebリクエストを送信し，300から400個のWebプロセスが常に実行中のとき，メニューまたは管理画面からWebサーバーを停止しようとした場合，アプリケーションがクラッシュしました。

* ACI0099692 プロパティリストにXLIFFシンタックスで入力したヘルプTipsがプ正しく登録されませんでした。

* ACI0099682 配列型リストボックスのコントロール配列を明示的に宣言しなかった場合，行の高さ配列はテキスト型の変数，行の制御配列は未定義の変数になりました。そのままアプリケーションをコンパイルモードで実行すると，フォームの動作が非常に遅くなりました。リストボックスだけでなく，他のテキスト入力エリアも影響を受けます。

* ACI0099824 ``Current user``を実行するとシステム変数``OK``に``1``が代入されました。

* ACI0099817 クライアント/サーバー版のみ。ストアドプロシージャで``Current user``を実行した場合，空の文字列が返されました。「サーバー上で実行」メソッドでは問題ありません。

* ACI0099810 Mac クライアント/サーバー版のみ。起動した直後に4D Serverが最前面アプリケーションになりませんでした。Dockのアイコンをクリックするまで，メニューバーが切り替わりません。

* ACI0099806 オブジェクトメソッドまたはフォームメソッドをプロジェクトモードに変換した場合，テーブル名が省略されたフィールドの参照が正しくトークナイズされずシンタックスエラーになりました。

* ACI0099805 Mac版のみ。テキスト入力エリア間でドラッグ＆ドロップした場合，文字列が移動する代わりにコピーされました。コピーは「``option``キーを押しながらドラッグ＆ドロップ」操作のはずです。

* ACI0099803 フォームエディターでページを削除したときに繰り上がって表示されるページにリストボックスが存在する場合，アプリケーションがクラッシュしました。

* ACI0099800 ``MAIL Convert to MIME``に``Null``が渡された場合，アプリケーションがクラッシュしました。

* ACI0099797 リストボックスに表示されたエンティティセレクションのカレント項目オブジェクトに対して``entity.next()``または``entity.previous()``を使用した場合，エンティティセレクションの最適化コンテキストではなく，カレント項目オブジェクトのバーチャルコンテキストのほうが使用されるべきですが，実際にはエンティティセレクションの最適化コンテキストが使用されてしまうため，フォームに表示されたリレーション属性のクエリにより，エンティティセレクションの最適化コンテキストに不要な属性が追加されてしまいました。

* ACI0099796 Mac版のみ。プロジェクトモードでリストボックスの「フォーカスの四角を隠す」プロパティを有効にしても，フォーカスの四角が表示されました。

* ACI0099795 プロジェクトモードで入力不可の階層リストに表示された項目を上下矢印キーや英字キーで選択することができませんでした。

* ACI0099794 アプリケーションパッケージ内に``%``記号から名前が始まる画像ファイルがあるためにWiseでインストーラーを作成することができませんでした。

* ACI0099789 Windows 64ビット版のみ。旧式プリントレイヤー（GDIモード）では，プリントプレビューで用紙の向きが無視され，横向き（landscape）に出力することができませんでした。

* ACI0099787 プロジェクトモードでフォームエディターを開いた場合，プロパティリストからプラグインエリアのカスタムプロパティ設定にアクセスできませんでした。ACI0099778と同じ問題です。	

* ACI0099784 Mac版のみ。多数のプロセスで同時に``Semaphore``でグローバルセマフォにアクセスした場合，プロセスが終了した後もシステムスレッドが残存し，やがてアプリケーションがクラッシュする恐れがありました。ローカルセマフォでは問題ありません。

* ACI0099783 Windows 64ビット版のみ。クイックレポートのページ設定ダイアログでページ余白を変更した場合，設定が保存されませんでした。

**注記**: 修正により，設定が保存されるようになりましたが，余白に指定が印刷に反映されない，という別の問題がありました（ACI0099994）。

* ACI0099777 互換性のデータベース設定「アプリケーション配布に新しいアーキテクチャーを使用する」が無効にしてサーバーアプリケーションをビルドした場合，最後に開いたデータファイルのパスが使用されず，毎回，「データファイルを作成または選択」ダイアログが表示されました。

* ACI0099776 フォームエディターとランタイムではデフォルトボタンの外観が違いました。

* ACI0099773 テキスト入力エリアのプロパティで自動ドラッグと自動ドロップを有効にした上で「ドラッグ可」と「ドロップ可」を無効にした場合，ドラッグ＆ドロップができませんでした。

* ACI0099764 互換性のデータベース設定「新しいコンテキスト参照モードを使用しない」「Webフォーム変数の自動代入」を外し，「未知のURLから``/``を取り除く」は残したままプロジェクトモードにエクスポートした場合，変換ログファイルには，すでに外されている前者を無効にしたというメッセージが出力され，強制的に外された後者の情報が出力されませんでした。

* ACI0099759 クライアント/サーバー版のみ。ORDAとクラシックランゲージの「橋渡し」コマンドを続けて実行した場合，エラー ``1303``が返されることがありました。たとえば，同じエンティティセレクションに対して``USE ENTITY SELECTION``を続けて使用した場合，１回目のコールで作成されたカレントセレクションのIDが解放されてから，２回目のコールで新しいカレントセレクションが作成されるべきですが，コマンドを続けて使用した場合，解放される前に新しいカレントセレクションが作成されてしまい，結果的にコンテキストIDが無効になってしまいました。

* ACI0099758 クライアント/サーバー版のみ。ORDAの``dataClass.query()``のクエリ文字列に``order by``指示を含めた場合，返されるエンティティセレクションがソートされていませんでした。

* ACI0099757 クライアント/サーバー版のみ。ORDAの``entitySelection.orderByFormula()``のフォーミュラをリテラル文字列で渡した場合，メモリ割り当てエラーが返されました。

* ACI0099746 Write Proエリアのスモールキャピタル（小文字と同じ高さの大文字）テキストにアンダーラインまたは取り消し線を適用した場合，一貫した位置にラインが描画されませんでした。

* ACI0099744 クイックレポートエディターの列をリサイズした場合，カラムに設定された``String([Table_1]Field_1)``のような数式が``C1``になりました。

* ACI0099742 クライアント/サーバー版のみ。``entitySelection.drop()``を実行した場合，ロックされているために削除できなかったエンティティの数が返されませんでした。

* ACI0099741 クライアント/サーバー版のみ。エンティティが参照しているレコードがすでに削除されている場合，あるいはスタンプが更新されている場合，あるいは重複するプライマリーキーが存在する場合，ORDAの``entity.save()``は失敗するはずですが，クライアント/サーバー版ではステータスオブジェクトの``success``プロパティに``true``が返されました。

* ACI0099740 クライアント/サーバー版のみ。保存オプションが「レコードの外」または「データファイルの外」に設定された属性が存在する場合，``dk auto merge``モードで実行したORDAの``entity.save()``は失敗するはずですが，クライアント/サーバー版ではステータスオブジェクトの``success``プロパティに``true``が返されました。

* ACI0099738 ``entity.lock()``が``dk reload if stamp changed ``モードで失敗した場合，スタンドアロン版では``ON ERR CALL``でエラーを処理することができませんでした。また，クライアント/サーバー版ではステータスオブジェクトにエラー情報（``status`` ``statusText`` ``wasReloaded``）が含まれていませんでした。


* ACI0099681 クライアント/サーバー版のみ。エンティティセレクション型のリストボックスの行をダブルクリックした場合，初回だけ一部の属性が``null``でした。

* ACI0099679 Windows版のみ。``SGV_ABOUT``メソッドを実行した場合，エラー``-9996``（スタック不足）が返されました。

* ACI0099676 クライアント/サーバー版のみ。ループ処理の中でORDAの``entitySelection.query()``をリレーション属性に対して実行した場合，初回した正しい結果が返されませんでした。ORDAの過剰なネットワーク最適化により，ループ処理の中でリレーション属性のエンティティがリロードされていないようです。

* ACI0099666 フォームのページ``0``にオブジェクトが配置されている場合，そのオブジェクトがフォーカス不可であったとしても，標準アクションのレコードナビゲーションを実行するたびにフォームオブジェクトのフォーカスが失われました。期待されるのは，タブ移動が有効に設定されている最初のフォーカス可オブジェクトにフォーカスが留まることです。

* ACI0099656 単一行のテキスト入力エリアで``page up`` ``page down``キーを入力した場合，``On After Keystroke``イベントが発生しませんでした。

* ACI0099647 Windows 32ビット版のみ。クライアント側でウィンドウの開閉を繰り返していると，アプリケーションがクラッシュすることがありました。メニューバーの管理が関係しているようです。

* ACI0099637 ストラクチャエディターのインスペクターに日本語でテーブルまたはフィールドの名前を入力した後，``return``キーを``3``回（日本語入力の確定・テキスト入力の確定・次のオブジェクトにタブ移動）してからストラクチャエディターのウィンドウをクリックし，再度，インスペクターのウィンドウをクリックしてテーブルまたはフィールドの名前を入力しようとした場合，日本語入力ができませんでした。インスペクターのウィンドウを閉じてから再表示させると，日本語入力ができるようになります。

* ACI0099619 64ビット版のみ。FTPコマンドでファイルがダウンロードできないことがありました。``FTP_GetDirList``は``MDTM``コマンドを送信しますが，サーバーがこのコマンドをサポートしていない場合，``FTP_Receive``でエラーが返されました。

* ACI0099616 メソッドエディターで``command``/``control``+``L``のキーボードショートカットを入力しても，「行番号に移動」ダイアログが表示されませんでした。

* ACI0099609 プラグインSDKのエントリーポイント``PA_GetVariable``で名前にアクセント文字が含まれている変数にアクセスした場合，変数が未定義とみなされました。

* ACI0099606 ``PRINT LABEL``のパラメーターを省略した場合，シンタックスエラーが返されました。具体的には``PRINT LABEL (aTable)``および``PRINT LABEL (aTable;*)``の構文が使用できませんでした。

* ACI0099594 リストボックスのヘッダー・列・フッターに設定されるデフォルトのオブジェクト名が正しくありませんでした。

**注記**: 修正により，日本語版ではデフォルトのオブジェクト名がローカライズされないようになりました。

* ACI0099586 カレントセレクション型のリストボックスがフォーカスされた状態で下矢印キーを入力した場合，最初の行がハイライトされます。この状態でクエリを実行し，レコードの並び順を変更してから，再び下矢印キーを入力した場合，最初の行ではなく，それまでハイライトされていた行（１行目）の下にある行が選択されました。期待されるのは，クエリの実行でハイライトがリセットされることです。

* ACI0099581 パラメーターを省略して``ds.startRequestLog()``を実行した場合，以前のコールで渡された数値（バッファサイズ）が継承されますが，初回のコールでパラメーターを省略した場合，関係のないエラーメッセージが返されました。

* ACI0099534 クライアント/サーバー版のみ。トランザクション中に時間型または日付型の属性に対して``collection.sort()``メソッドを実行した場合，結果が正しくありませんでした。

* ACI0099512 テキスト入力中に``home``キーを使用した場合，キャレットが行の先頭ではなく，段落の先頭に移動しました。``end``キーでも同様のことが起きます。

* ACI0099254 リストボックスやリストフォームをダブルクリックして詳細フォームに遷移した場合，ナビゲーション用の標準アクションボタンをクリックしてロックされているレコードから別のレコードに移動すると，ロックされていないレコードもロックされているように表示されました。

* ACI0099239 ``QUERY BY ATTRIBUTE``およびORDAでは，オブジェクトフィールド内の属性に対して「リンク」したクエリを記述することができますが，日付型の属性では，これが正しく動作しませんでした。

* ACI0099197 Mac 64ビット版のみ。シートウィンドウを表示した場合，``On Activate`` ``On Deactivate``フォームイベントが発生しませんでした。

* ACI0099079 送信メールの設定を``SMTP_SetPrefs (0;2;0)``にセットした場合，MIMEに挿入される改行コード（``CR`` ``LF``）の数が正しくありませんでした。

* ACI0099050 ラベルエディターを閉じてから，再び開いた場合，最後に使用したラベル設定ファイルがロードされた状態でダイアログが表示されませんでした。

* ACI0098990 スタイル付きテキストを印刷コマンドでPDFに出力した場合，``span``タグの``text-align``スタイルプロパティがレンダリングに反映されませんでした。ACI0095913が印刷コンテキストでは修正されていませんでした。

* ACI0098479 Windows版のみ。小さなWrite Proエリア上で右クリック操作をした場合，アプリケーションがクラッシュしました。

* ACI0098412 クイックリポートエディターでレポートを新規作成した場合，メニューに表示されるカラムの情報がリセットされませんでした。

* ACI0098009 「フッターを表示」および「カラム自動リサイズ」が有効にされているリストボックスの列を水平方向にリサイズした場合，リストボックスの垂直スクロールバーが表示されませんでした。

* ACI0096405 マウスポインターがサブフォーム内の入力可オブジェクトを指している場合，マウスのロールボタンでサブフォームをスクロールすることができませんでした。

* ACI0095371 Mac版のみ。AppleScriptで4D Serverを終了した場合，エラー``-128``が返されました。
