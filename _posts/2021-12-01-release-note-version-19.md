---
layout: fix
title: "4D v19.1 Hotfix 1 修正リスト"
date: 2022-01-19 08:00:00
categories: 修正リスト
tags: 19.1 hotfix
build: 275164
version: 19.1
permalink: /335/:slug/
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}} 
 
* ACI0102290 空のコレクションに対して`IN`比較演算子を使用して`collection.query()`を実行した場合，アプリケーションがクラッシュしました。

* ACI0102578 `WP Get position`から返される`bounds.left`の値が正しくないことがありました。段落の直後にある空行にカーソルを置いた場合，`WP Text range`はカーソルの位置ではなく段落の最終位置を返すようです。

* ACI0102606 コンパイルモードでは`#DECLARE`構文で宣言したパラメーター名の大文字と小文字が区別されました。
 
* ACI0102574 メニューバーにピクチャライブラリのスプラッシュ画像が設定されている場合，ストラクチャをプロジェクトに変換すると，スプラッシュ画像の参照が失われました。

* ACI0102556 メソッド名に日本語が使用されている場合，Apple Siliconターゲットのコンパイルが失敗することがありました。`LAUNCH EXTERNAL PROCESS`で日本語のファイル名が`clang`に渡されていますが，UTF-8の日本語はShift_JISよりもバイト数を必要とすることが考慮されていないようです。

* ACI0102537 バーチャルストラクチャでフィールドタイトルが設定されている場合，`PRINT LABEL`を実行すると，フィールド値ではなくフィールド名がラベルに出力されました。

* ACI0102524 同一ドキュメント内で`4DEACH`タグと`4DLOOP`タグの両方を実行することができませんでした。

* ACI0102487 Windows版のみ。`entity.fromObject( )`でＮテーブルのエンティティにＮ対１リレーション属性に値を代入しようとした場合，１対Ｎリレーション属性の値が代入されました。

* ACI0102237 `RESTORE`でバックアップの復元が成功した後，`DOCUMENT`システム変数が更新されませんでした。

* ACI0098106 データベースパラメーターの`Dates inside objects`が`String type without time zone`に設定されている場合，ISO 8601フォーマットでコレクションに登録された日付文字列が`COLLECTION TO ARRAY`で日付型に変換されませんした。

* ACI0102577 プロパティリストでボタンのタイトルを変更し，項目の入力を確定せずにフォームを閉じた場合，値が更新されませんでした。

* ACI0102576 リストボックスのヘッダーの画像ソースに値が設定されていない場合，ストラクチャをプロジェクトに変換すると，当該プロパティが存在しないリストボックスになりました。

* ACI0102575 バイナリモードの新規ストラクチャを作成した場合，リストボックスのヘッダーの画像ソース（変数名）がプロパティリストに表示されませんでした。

* ACI0102572 クライアント/サーバー版のみ。新規プロセスで`Create entity selection`を実行し，エンティティセレクションを作成した場合，メモリーリークが発生しました。

* ACI0102379 `IMAP_MsgLst`から返される件名のアクセント文字が間違っていることがありました。

* ACI0102549 Apple Siliconのみ。負の値を減算するようなコードがコンパイルエラーになりました。

* ACI0102553 Windows版のみ。リストボックスの自動行高が有効にされており，システムにインストールされていないフォントがセルに設定されている場合，行が完全に表示または印刷されずに途切れることがありました。

* ACI0102536 未確定（入力中）の日本語変換文字列を`delete`キーですべて削除した場合，確定済の文字列も`1`文字削除されました。

* ACI0102558 クライアント/サーバー版のみ。リレーション属性と一緒にエンティティセレクションを`entitySelection.toCollection()`でコレクションに変換した場合，クライアント接続が切断されるまでエンティティセレクションが解放されずにメモリーリークが発生しました。

* ACI0102197 クライアント/サーバー版のみ。ストアドプロシージャを起動したクライアントのネットワーク接続が強制的に切断された場合，ユーザー数とライセンス数の計算が合わなくなりました。クライアントがクラッシュしたり，ネットワーク接続が切断された場合には，クライアント接続ライセンスが解放されるべきです。

* ACI0102566 Mac版のみ。`Folder("/").folders()`から返されるフォルダーオブジェクトは`///`というプリフィックスがパスに追加されました。親フォルダーのパスが`8`文字に満たない場合に問題が発生します。

* ACI0102530 新規データファイルを作成した直後にトランザクションを開始し，レコードを追加してトランザクションを確定しないままインデックスフィールドの並び替えを実行した場合，アプリケーションがクラッシュしました。
 
* ACI0102454 プリエンプティブプロセスでSQLコードを実行し，`FN`ステートメント経由でメソッドをコールした場合，サーバーがクラッシュしました。

* ACI0102425 クラス関数の中で`WEB SET HTTP HEADER`を使用した場合，常に`200 OK`のHTTPステータスコードが返されました。プロジェクトメソッドで使用すれば問題ありません。
 
* ACI0102534 クライアントが終了してもサーバー側のエンティティセレクションが解放されないことがありました。

* ACI0102533 Mac版のみ。関連フォルダーを含めずにプロジェクトをコンパイルした場合，*Librairies*フォルダー内の*lib4d-arm64.dylib*ファイルが上書きされませんでした。
 
* ACI0102374 インタープリターモードのみ。配列型リストボックスの制御配列プロパティに倍長整数型の配列が使用されている場合，フォームのロード時に配列がブール型で再初期化されました。

**注記**: ブール型配列で行の表示/非表示だけを制御する古い仕様は，互換性のために引き続きサポートされています。修正により，フォームのロード時に制御配列プロパティの配列が宣言されていない場合，デフォルトで倍長整数型の配列が使用されるようになりました（修正前はブール型）。すでにブール型で宣言されている場合に限り，制御配列がブール型となります。今後，制御配列がプロパティリストに入力されているだけで，コードのどこでも宣言されていない場合，制御配列に対するブール値の代入はエラーとなります。

* ACI0102418 [自動行高](https://doc.4d.com/4Dv19/4D/19/List-box-column-specific-properties.300-5416755.ja.html)に設定されたリストボックスを`Print object`で印刷した場合，最終行がページにまたがって出力されたり，途切れて出力されることがありました。問題が発生する条件は，用紙のマージン設定や印刷するリストボックスの内容に左右されます。

* ACI0102380  データ言語が「日本語」に設定されており，「テキスト検索用の文字列比較を使用する」モードが有効にされている場合，`Compare strings`でカナを区別しない比較（`sk kana insensitive`）が正しく動作しませんでした。`sk diacritic insensitive`または`sk case insensitive`を併用すれば問題ありません。

**注記**: ICUのレベル`3`コレーション（アクセントの有無および文字列の大小を区別する）と言語特有の`Alternate`指定（テキスト検索用の文字列比較を使用する）を併用することはできません。言語特有の`Alternate`指定が有効にされている場合，レベル`2`コレーションが使用されます。修正により，文字列の大小を区別するためにはレベル`3`コレーションではなく，`CaseLevel`オプションが使用されるようになりました。このオプションは，レベル`1`コレーションをベースに文字列の大小だけを区別するモードで使用されているオプションと同じものです。つまり，他言語ではアクセントの有無および文字列の大小を区別するためにレベル`3`コレーションが使用されますが，日本語版では，レベル`2`コレーションと文字列の大小を区別するための`CaseLevel`オプションが併用されるようになりました。

<i class="fa fa-external-link" aria-hidden="true"></i> [ICU Documentation](https://unicode-org.github.io/icu/userguide/collation/concepts.html)

* ACI0102506 アカウント情報の氏名または会社名にアクセント記号が使用されている場合，ライセンスのアクティベーションができませんでした。

* ACI0102472 アップグレードしたデータベースの場合，一部のプロジェクトメソッドがWSDLで公開されないことがありました。

* ACI0102431 開くカッコ記号がコードに記述されており，閉じるカッコ記号がコメントに記述されている場合，開くカッコの位置にキャレットを移動してもブレースマッチングが働きませんでした。

* ACI0102529 プロジェクトモードのみ。プロジェクトに変換したフォームオブジェクトのヘルプTIpsがプロパティリストに`[object Object]`と表示されました。

* ACI0102468 Windows版のみ。固定サイズのフォームのタイトルバーを右クリックしてウィンドウを最大化した場合，一部のボタンが消えてしまうことがありました。

* ACI0101959 プロジェクトモードのみ。プロジェクトに変換したアプリケーションのツールボックスで作成したヘルプTipsにインタープロセス変数とSTR#リソースのインデックスが使用されている場合，オブジェクトのヘルプTipsが正しく表示されませんでした。

* ACI0102354 メソッドを複数の行に分割した場合，2行目以降のタイプアヘッドで表示される補完候補には入力途中の変数名も含まれました。
 
* ACI0102447 コンポーネントで`RESOLVE POINTER`を使用した場合，プリエンプティブプロセスではホストの変数に対するポインターを逆参照することができませんでした。

* ACI0102185 コンポーネントメソッド*SVG_Get_version*が`0.0`という値を返しました。

**注記**: 修正により，コンポーネント特有のバージョン番号ではなく，実行中の4Dバージョンが返されるようになりました。

* ACI0102486 バイナリモードからプロジェクトをエクスポートした場合，名前が数字で始まるスタイルシートのCSSファイル名やクラス名がバックスラッシュ記号でエスケープされ，正しく参照されませんでした。

* ACI0102467 ビルド版アプリケーションでオブジェクト型に対するポインターをバリアント型メソッドパラメーターに渡した場合，アプリケーションがクラッシュしました。デバッグログを有効にしていれば問題ありません。ビルドしていないコンパイルモードでも問題ありません。

* ACI0102465 プロジェクトモードのみ。階層リストボックスにフォント属性のボールドまたはイタリック体を設定できないことがありました。アンダーラインは問題ありません。CSSでシステムフォントが設定されている場合に問題が発生します。

**注記**: システムフォントは有効なフォントファミリー名ではありません。

* ACI0102462 特定のFTPサーバー（FileZilla）に対して`FTP_GetDirList`または`FTP_GetFileInfo`を実行した場合，コマンドが失敗しました。プラグインが`LIST -a`コマンドを送信しており，サーバーがこの命令に対応していないためです。

**注記**: 修正により，まず`LIST -a`が送信され，エラーが返された場合，`LIST`が送信されるようになりました。

* ACI0102457 壊れた`.eml`ファイルを`MAIL Convert from MIME`で読み込もうとした場合，アプリケーションがクラッシュすることがありました。

* ACI0102451 IMAPトランスポーターの`getMails()`でメモリーリークが発生しました。プロセスが終了した後もメール受信に使用したメモリが解放されませんでした。

* ACI0102440 Windows版のみ。複数のページにTIFF画像が挿入されている4D WriteドキュメントをWrite Proに変換し，印刷しようとした場合，不明なエラーが返されました。`.xps`またはMicrosoft Print to PDFでは問題ありません。

* ACI0102397 リストボックスの「シングルクリック編集」モードが有効にされている場合，行をダブルクリックしてから下方にスクロールし，別の行をダブルクリックすると，間違った行がハイライト選択されました。最初のクリックでセルの編集モードに切り替わり，ダブルクリックで編集モードがキャンセルされるものの，最初のクリックでスクロールが発生するため，クリック目標が動いてしまうことが原因です。

* ACI0102503 プロジェクトモードでは，コンパイラーのシンボルファイルおよびエラーファイルはいずれもログフォルダーに出力されますが，[ドキュメント](https://developer.4d.com/docs/ja/Project/compiler.html)には「プロジェクトフォルダー内に・・・」と[バイナリモード](https://doc.4d.com/4Dv19R3/4D/19-R3/Compiler-page.300-5612618.ja.html)の動作が記載されていました。

**注記**: ドキュメントが修正されました。

* ACI0102446 文字列の添字シンタックス（``string[[index]]``）とドット記法を組み合わせた場合，シンタックスエラーになりました。

```
var $a : Text
var $b : Object
$a:=$a[[$b.c]]
```

* ACI0102279 地域と言語の設定が「英国」のシステムでデータベース設定画面の「？」ボタンをクリックした場合，ドキュメントページに「インデックス範囲外」エラーが表示されました。言語識別子が`en`ではなく`gb`のページを表示しようとするためです。

* ACI0102164 Windows版のみ。サーバー管理画面の検索ツールの虫眼鏡アイコンがテキスト入力の邪魔になっていました。

* ACI0101994 リストボックスのセルに選択リストが設定されている場合，テキストの垂直揃えが通常のセルよりも少しだけ高くなりました。

* ACI0101929 クイックレポートエディターのクロスタブツールに問題がありました。セルを選択したときに表示される吹き出し（ポップアップウィンドウ）の位置が左に寄っていました。

* ACI0102341 フランス語版のみ。メソッドエディターに`WP INSÉRER FORMULE`コマンドが入力できませんでした。`WP INSERT FORMULA`と入力する必要がありました。

* ACI0102368 フォームを表示した直後に`FORM GOTO PAGE`でページ移動した場合，一瞬だけページ`1`が表示されました。

* ACI0102105 Windows版のみ。サーバー管理画面の「モニター」「ユーザー」「プロセス」といったタブの表示に問題がありました。クリック時またはマウスオーバー時にボタン画像の左側が正しく表示されませんでした。

* ACI0102386 クライアント/サーバー版のみ。重複不可属性・Bツリーインデックス・キーワードインデックスが設定されているフィールドに対してトランザクション中に`entity.save()`を実行した場合，Bツリーではなくキーワードインデックスが更新され，加えてキーワードインデックスに対して重複のチェックが実施されるため，アプリケーションがクラッシュしました。キーワードインデックスの設定を解除すれば問題ありません。
