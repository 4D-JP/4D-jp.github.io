---
layout: fix
title: "4D 20.3 Hotfix 2 修正リスト"
date: 2024-05-30 08:00:00
categories: 修正リスト
tags: 20.3 hotfix
build: 101304
version: "20.3"
permalink: /2024/127/:slug/
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}} 

* ACI0104406 テーブルに複合インデックスが設定されている場合，`QUIT 4D`の実行後にアプリケーションがフリーズすることがありました。

* ACI0104813 クライアント/サーバー版のみ。リレーションエンティティを作成する前に新規エンティティのリレーション属性に外部キー値を代入してエンティティを保存した場合，代入した外部キー値ではなく空値が保存されました。

* ACI0104453 コンパイルモードのみ。別々のプリエンプティブWebプロセスから`Storage`経由でオブジェクトまたはコレクションにアクセスする処理が引き金となってアプリケーションがクラッシュする可能性がありました。

* ACI0104800 RESTでフェッチしたエンティティをデバッガーでトレースした場合，計算属性を評価しようとしたところでアプリケーションがクラッシュしました。メンバー関数のコードに`TRACE`が記述されていなければ問題ありません。

* ACI0104753 ループ処理で`HTTP Get`を実行した場合，`Content-Length`ヘッダーがリセットされませんでした。

* ACI0104342 コンパイルモードのみ。`SET HELP MENU`でインストールした*ak msc* アクションをサーバー側のヘルプメニューから実行した場合，ランタイムエラーが返されました。`INVOKE ACTION`を実行するための`4D_Server_Interface`ワーカーがプリエンプティブプロセスで起動されているためです。

* ACI0104764 Windows版のみ。Write Proドキュメントを*wk pdf* 形式でエクスポートした場合，Unicodeの結合文字を使用したウムラウトが正しい位置に表示されませんでした。プリンタードライバー経由でPDFを出力すれば問題ありません。

**注記**: [Hummus PDF-Writer](https://github.com/galkahana/PDF-Writer/issues/251)の不具合でした。レンダリングの問題を回避するため，合成文字のウムラウトが出力されるようになりました。

* ACI0104758 プロジェクトモードのみ。互換性の「[ピリオドとカンマを数値フォーマットのプレースホルダーとして使用する](https://doc.4d.com/4Dv20/4D/20.2/Compatibility-page.300-6750362.ja.html)」が無効にされているストラクチャーをプロジェクトに変換した場合，ピリオドや空白を桁区切りとして使用するシステムで`####0,00%;-####0,00%;0,00%`のようなフォーマットを`String`関数で数値に適用した場合，カンマが小数点ではなく，桁区切り記号として処理されるようになりました。

**注記**: プロジェクトモード変換の仕様が変更されました。以前は「ピリオドとカンマを数値フォーマットのプレースホルダーとして使用する」が強制的に有効化され，変換ログにも下記の警告が出力されました。

```json
{
  "message": "Compatibility setting 'Use period and comma as placeholders in numeric formats' switched on.",
  "severity": "warning"
}
```

修正により，この設定は保持されるようになりました。プロジェクトモード変換後にデータベース設定で有効化することができます。

* ACI0104752 Write Proの小数点タブが文字列の後に続くスペースに対して適用されませんでした。Microsoft Wordと同じように処理されるべきです。
 
### Write Pro（修正前）
![](https://github.com/4D-JP/4D-jp.github.io/assets/10509075/8b231b0e-865b-45b3-838d-150bb77cc959)

### Word（参考）
![](https://github.com/4D-JP/4D-jp.github.io/assets/10509075/8a57fcba-f1c6-4277-a2bc-afb77f219d17)

* ACI0104596 [サーバー側のORDAリクエストログ](https://developer.4d.com/docs/ja/Debugging/debugLogFiles/#サーバー側)に`ipAddress`（クライアントのIPアドレス）が出力されませんでした。

* ACI0104698 Mac版のみ。*Modal form dialog box* タイプのウィンドウからポップアップウィンドウを表示した場合，テキスト入力オブジェクトに数字をタイプ入力することができませんでした。

**注記**: Appleの仕様では非アクティブのウィンドウにフォーカスを設定することはできないことになっていますが，4Dはポップアップウィンドウが非アクティブであってもタイプ入力ができる（したがってフォーカスを設定することができる）仕様になっています。今回の修正には，Appleの仕様を迂回することが関係しています。IMEは，非アクティブであるポップアップウィンドウの背後に表示されるので，隠されてしまわないよう，ポップウィンドウにテキストを入力している間はウィンドウの外に表示されます。過去バージョンの動作を再現するために問題は修正されましたが，テキスト入力が必要であれば，ポップアップウィンドウではなく，フローティングウィンドウを使用することが勧められています。

* ACI0104669 メソッドエディター上で`Case of`構文の条件ブロックを畳んだ状態で別の条件ブロックカットまたは削除し，`command`+`Z`で操作を取り消した場合，コードが正しく復元されませんでした。

* ACI0104603 フォームエディターのプロパティリストで関連メニューバーを「なし」に設定した場合，*form.4DForm* ファイルの`menuBar`プロパティが*none* に更新され，プロパティリストのラベル表示がエラーを意味する赤いタイトル文字に変化しました。関連メニューバーを「なし」に設定した場合は値が空になるべきです。

**注記**: 問題は修正されましたが，すでにメニューバーが*none* に設定されている既存のフォームは修正されません。なお，プロパティリストにおける表示上の不具合であり，動作には問題ありません。手作業で修正するには，有効なメニューバーを設定した後，*control* キーを押しながらプロパティリストのラベルをクリックして設定をクリアしてください。

* ACI0104797 Windows版のみ。`GET SERIAL PORT MAPPING`で`COM9`より高いポートを取得することができませんでした。

* ACI0104789 Windows版のみ。`SET PRINT OPTION`で設定した*Orientation option* の設定が`QR RUN`で出力したレポートの`2`ページ目以降に反映されませんでした。PDF/XPSに出力した場合は問題ありません。なお，印刷ジョブを開始する前に用紙の方向を設定すれば問題ありません。

**注記**: Direct2Dモードで印刷中に用紙の方向を変更した場合の処理が修正されました。

* ACI0104771 セレクション型リストボックスのハイライトセットが設定されていない場合，選択されたレコードを標準アクションの「サブレコード削除」または`INVOKE ACTION`で削除することができませんでした。

* ACI0104686 CSSの`verticalAlign`プロパティを使用してリストボックス列の垂直揃えを設定した場合，フォームエディターのプレビュー表示にプロパティが反映されませんでした。フォーム実行時のレンダリングは問題ありません。

* ACI0104597 *On Server Startup* データベースイベントで新規プロセスを起動して開いたウィンドウのオブジェクトメソッドで`OPEN ADMINISTRATION WINDOW`を実行した場合，何も起きませんでした。

**注記**: 管理ウィンドウはヘルプメニューのショートカットで開くことができますが， プロセスにメニューバーがインストールされておらず，フォームにメニューバーが関連付けられていない場合，管理ウィンドウを開くためのメニューコマンドが処理されないことが原因でした。パレットタイプのウィンドウであれば，アプリケーションプロセスのメインメニューが使用されます。修正により，どちらのケースでも管理ウィンドウが表示されるようになりました。

* ACI0104447 `CREATE INDEX`でインデックス設定を更新した場合，ストラクチャエディターには変更が反映されますが，SQLシステムテーブルはプロジェクトを再起動するまで更新されませんでした。

* ACI0104805 ビルド版シングルユーザーアプリケーションで`WEB START SERVER`またはデータベース設定の「開始時にWebサーバーを起動」を使用した場合，アプリケーションがクラッシュすることがありました。

* ACI0104775 メールオブジェクトをMIME形式に変換した場合，`messageId`の値に余計なエンコードが適用されました。

**注記**: 修正により，`Message-ID`ヘッダーは`76`文字を超過しても折り返されないようになりました。

* ACI0104730 データエクスプローラーの詳細フォームに`<script>`タグを利用して*JavaScript* コードを実行させることができました。

* ACI0104188 フィールド値に`<`または`>`記号が含まれている場合，データエクスプローラーの表示が崩れました。