---
layout: post
title: "ヘルパーツールのアンインストール"
date: 2019-01-07 22:14:54
categories: セットアップ
tags: 17r2 mac
excerpt: "17r2以降，Webサーバーを公開するためのヘルパーツール（Mac版）の仕様と名称が変更されています。ヘルパーツールが正しい方法でアンインストールされていない場合，Webサーバーの公開で競合が発生するかもしれません。"
version: 17r2

---

macOSで``1023``以下のTCPポート番号を使用するには，通常，管理者権限が必要です。しかし，サーバーを起動するたびに管理者のパスワードを入力するのは面倒なので，専用のシステム常駐プログラム（ヘルパーツール）を管理者権限でインストールし，ポートを開くことをそのアプリケーションに代行させる，という仕組みが用意されています。

v2004以降，ポート番号を開くためのヘルパーツール``HelperTool``と，それをインストールするためのインストーラー``InstallTool``が4Dのアプリケーションと一緒に配付されています。

v2004からv17r2のヘルパーツールは，Appleの[BetterAuthorizationSample](https://developer.apple.com/legacy/library/samplecode/BetterAuthorizationSample/Introduction/Intro.html)というサンプルに基づいています。

ヘルパーツールのアーキテクチャ（32または64ビット）は，アプリケーション本体と同じものがインストールされます。名称は， ``com.4D.HelperTool``です。

ヘルパーツールは，``WEB START SERVER``コマンドを実行した場合，サーバー管理画面の「HTTPサーバー開始」ボタンをクリックした場合，あるいはデザインモードの「Webサーバー開始」メニューを選択した場合にインストールされます。データベース設定の「開始時にWebサーバーを起動」オプションは，すでにヘルパーツールがインストールされている環境（あるいは1024以上のポート番号しか使用しないアプリケーション）で使用してください。

ヘルパーツールをインストールするアプリケーションは，コード署名されていなければなりません。4Dでは，コード署名に必要なAppleのデベロッパープログラムに加入しなくても，アプリケーションビルドができるよう，ヘルパーツールをインストールするだけのアプリケーション（署名済み）を提供しています。

17r3では，Appleの[EvenBetterAuthorizationSample](https://developer.apple.com/library/content/samplecode/EvenBetterAuthorizationSample/Introduction/Intro.html)に基づき，ヘルパーツールがアップデートされています。新しいヘルパーツールアーキテクチャは，常に64ビットです。新旧のヘルパーツールが共存できるよう，名称は``com.4D.Helper``に変更されています。

ヘルパーツールは，``PriviledgedHelperTools``フォルダーにインストールされます。しかし，直接，常駐プログラムのファイルを削除することは推奨されていません。そうではなく，コマンドラインからヘルパーツールのインストーラー``InstallTool``にパラメーターを渡してアンインストールする必要があります。

```
cd {4D.appのディレクトリ}
sudo 4D.app/Content/MacOS/InstallTool.app/Content/MacOS/InstallTool --uninstall
```

正しい方法でヘルパーツールをアンインストールしなかった場合，Webサーバーの開始時にアプリケーションがフリーズするかもしれません。
