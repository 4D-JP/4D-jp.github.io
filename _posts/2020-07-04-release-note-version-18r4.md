---
layout: fix
title: "4D v18r4 修正リスト"
date: 2020-07-04 08:00:00
categories: 修正リスト
tags: 18r4  
build: 253814
version: 18r4

---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}}  

* ACI0100649 Mac 64ビット版のみ。プラグインSDKのエントリーポイント``PA_GetKey``は，``option``キーの補助を利用して入力したアクセント文字を返しませんでした。U.S.キーボード配列の場合，``option``キーを押しながら``u`` ``e`` ``i`` のようなキーを押すことにより，結合用のアクセント記号を入力することができますが，``PA_GetKey``は，そのような文字に対して``0``を返し，続けて入力されたキーをアクセント記号がない文字のコードを返しました。

* ACI0100632 4D Write Proエリアをズームするたびに``On Data Change``イベントが発生しました。

* ACI0100631 4D Write Proエリアに数式を挿入した場合，``On Data Change``イベントが発生しませんでした。

* ACI0100630 4D Write Proエリアのスクロールバーを操作した場合，``On Data Change``イベントが発生しました。

* ACI0100629 トランスポーターで送信したメールの件名に含まれるスペース記号が``_``文字にエンコードされず，そのまま送信されました。

* ACI0100622 クライアント/サーバー版のみ。``dataClass.get()``のプライマリーキーに空の文字列を渡した場合，スタンドアロン版では``null``が返されましたが，クライアント/サーバー版ではそれぞれの属性が``null``にセットされたエンティティが返されました。

* ACI0100620 日本語ではないシステム言語設定で日本語のファイル名を添付して``SMTP_Send``を実行した場合，エラー``-43``が返されました。

* ACI0100593 コンポーネントがコンパイルモードで実行されている場合，コンポーネントメソッドのパラメーターがデバッグログ（モード``2``または``6``）に記録されませんでした。

* ACI0100571 メールサーバーがExchangeまたはdovecotの場合，``POP3 Transporter``がフリーズしました。GMailでは問題ありません。

* ACI0100564 ``dataStore.canceTtransaction()``メソッドを実行した場合，トランザクション中に削除されたエンティティのロックが解除されませんでした。

* ACI0100556 Windows版のみ。CEF版Webエリアのテキスト入力にユーロ通過記号（``€``）を入力することができませんでした。代わりに「トーフ」が入力されます。32ビット版では問題ありません。ペースト操作であれば入力することができます。``Alt``キーを使用した特殊文字の入力全般の問題です。

* ACI0100487 ツールボックスのメニューエディターでピクチャライブラリから選んだ画像をスプラッシュ画面の背景イメージにすることができませんでした。

* ACI0100442 Webサービス（SOAP）メソッドからテキスト配列を返した場合，クライアント側（``WEB SERVICE GET RESULT``）でアプリケーションがクラッシュしました。サーバーから返されるXMLが正しくないためです。

* ACI0099944 ``Execute on server``のようなコマンドに渡されたパラメーターが明示的に型宣言されていない場合，コンパイルに失敗しました。期待されるのは，デフォルトでバリアント型になることです。

* ACI0099052 ``FTP_Receive``および``FTP_Delete``はデンマーク語の文字（``æøå``）に対応していませんでした。エラー``10060``が返されました。

* ACI0100854 同名のXML要素を``DOM Create XML element``で続けて追加した場合，呼び出しとは逆の順に要素が作成されました。つまり，既存の要素の直前に新しい要素が挿入されました。互換性オプションの「[標準XPathを使用する](https://doc.4d.com/4Dv18R3/4D/18-R3/Compatibility-page.300-4919546.ja.html)」が有効にされていなれば，問題ありません。

* ACI0100857 クラスのメンバーメソッドでクラスオブジェクト``This``をパラメーターとして``DIALOG``に渡した場合，呼び出し後に別のオブジェクトが返されました。フォームに表示したリストボックスのコードが使用している``This``に影響されているようです。

* ACI0100861 ``4DACTION``で呼び出されたメソッドから``WEB SEND TEXT``を使用した場合，メモリーリークが発生しました。コンポーネントの``WEB Server``で``4DINCLUDE``タグが使用できなかった問題（ACI0100832）が修正されたことによる副作用のようです。

* ACI0100868 Mac版のみ。4D for iOSの「プロダクションサーバーデータファイル」を有効にし，「公開」セクションにサーバーのIPアドレスとポート番号を入力した後，サーバー側の``mobileapps``から``key.mobileapp``をファイルをクライアント側にコピーし，「データ」セクションでローカルのキーファイルを選択しても，「サーバーはオンラインです」のメッセージが表示されませんでした。

* ACI0100891 プロジェクトモードのみ。フォームエディターからフォームを実行し，ウィンドウを移動またはリサイズして閉じた場合，次回の実行で配置が再現されませんでした。``geometryStamp``プロパティが更新されていないためです。

* ACI0100879 Windows版のみ。SDIモードアプリを実行し，外部モニターに表示したWrite Proインタフェースで新規スタイルシートを作成しようとした場合，保存ダイアログがメイン画面に表示されました。

* ACI0100877 Mac版のみ。iPadのシステム環境設定で4D for iOSアプリの「Send feedback」を有効にした場合，アプリからフィードバックが送信できるようになりますが，実際にはフィードバックメニューを操作することができませんでした。

* ACI0100875 バイナリデータベースをプロジェクトにエクスポートした場合，そのプロジェクトが開けないことがありました。書き出されたXMLにエラーがあるためです。

* ACI0100872 ``PICTURE PROPERTIES``の第１パラメーターにオブジェクトのピクチャ型プロパティを渡した場合，コンパイルモードでエラーが返されました。代わりにピクチャ型のローカル変数を使用すれば問題ありません。

* ACI0100853 サーバー管理画面の「ユーザー」あるいは「プロセス」ページを切り替えている最中に``Get process activity``を実行した場合，アプリケーションがクラッシュしました。

* ACI0100851 クライアント/サーバー版のみ。サーバーがWindows版の場合，１対Ｎリレーションが存在するテーブルに対して``dataClass.fromCollection()``メソッドを実行するとエラーが返されました。

* ACI0100847 64ビット版のみ。``SET CURRENT PRINTER("")``でカレントプリンターをデフォルトプリンターにリセットすることができませんでした。

* ACI0100846 Windows版のみ。地域と言語が英語（シンガポール）に設定されている場合，日付フォーマット（``System Date abbrievated``）が正しくありませんでした。``DD/MM/YY``ではなく``MM/DD/YY``で表示されました。

* ACI0100845 メールオブジェクトの``messageId``プロパティに空の文字列を設定してトランスポーターでメールを送信した場合，MIMEメッセージの``Message-ID``ヘッダーが中途半端（``<>``）な状態で出力され，メールがスパム扱いになる恐れがありました。``messageId``プロパティが未定義であれば，自動的に値が設定されるので，問題ありません。

* ACI0100844 Windows版のみ。MDIモードで最大化されたウィンドウを表示しているプロセスが新規ウィンドウを表示した場合，新しいウィンドウは最大化されていない状態で表示されますが，そのウィンドウをマウス操作でリサイズしようとすると，アプリケーションがクラッシュしました。

* ACI0100842 Mac版のみ。ZIP圧縮したアプリを``ZIP Read archive``で展開した場合，内部のシンボリックリンクがオリジナルのアイテムよりも先に展開されるため，アプリが起動できませんでした。

* ACI0100836 入力不可・フォーカス可のオブジェクトにフォーカスを移動した場合，テキストをコピーすることができますが，編集メニューの「コピー」はdisabled状態のままでした。

* ACI0100835 メソッドエディターでプロジェクトメソッド名を選択して「定義に移動」した場合，エディターでそのメソッドが開きませんでした。

* ACI0100832 ``WEB Server``コンポーネント内では``4DINCLUDE``タグが動作しませんでした。

* ACI0100831 ``WEB SEND FILE``をコンポーネント内で使用し，文字セットが特定できないファイルを送信した場合，アプリケーションがクラッシュしました。

* ACI0100826 Kerioのメールサーバーに対して``POP3 Transporter``の``getMail()``メソッドを使用した場合，``5``分間，アプリケーションがフリーズしたようになりました。``getMailInfoList()``から返されるバイト数と，最終的にダウンロードされるBLOBデータのサイズが一致しないことが関係しているようです。

* ACI0100825 SQLの``IN``句をインデックスフィールドに対して使用した場合，``IN``のリストが降順にソートされていないと，正しい結果が返されませんでした。

* ACI0100822 ``Open form window``コマンドにパラメーターとして渡されているテーブルフォーム名を範囲選択して「定義に移動」した場合，フォームエディターではなく，ストラクチャエディターのテーブルプロパティにジャンプしました。

* ACI0100821 ストラクチャをプロジェクトにエクスポートした場合，出力フォームに配置されたブール型フィールドが正しく変換されませんでした。

* ACI0100809 クライアント/サーバー版のみ。IPアドレスの「許可/拒否リスト」のエントリーにクライアントの「拒否」アドレスと「すべて許可」を組み合わせた設定を入力した場合，拒否」に設定されているアドレスからクライアントを接続することができました。たとえば

* ACI0100803 Write Proの表組に極太のボーダーを設定した場合，ラインに細い隙間が描画されました。

**注記**: 問題は修正されましたが，デフォルトの背景[クリッピングボックス](https://doc.4d.com/4Dv17/4D/17/Using-4D-Write-Pro-standard-actions.200-3726284.ja.html)が「段落」に設定されているため，アンチエイリアス処理により，背景カラーがボーダーにオーバーフローすることがあります。これが問題であれば，クリッピングボックスを「``padding-box``」に変更することができます。

* ACI0100801 Webサーバーのホームページが設定されていない場合，``Get 4D folder(HTML Root folder)``および``Folder(fk web root folder)``は絶対パスではなく，相対パスを返しました。

* ACI0100799 ``1``行 ``1``列にコマ割り設定されたピクチャボタンをクリックすると，アイコン画像が消えました。再度，クリックすると，ピクチャが再表示されます。

* ACI0100928 Mac版のみ。デザインモードのエクスプローラーで「ホーム」タブのフォルダーに収容されているクラスをメソッドエディターで開いた後，``command``+``W``または``command``+``S``を入力した場合，クラスが「ホーム」タブから消えることがありました。アプリケーションを再起動すると，「ホーム」タブのトップレベルにクラスが移動していることが確認できます。

* ACI0100923 新しいXPathシンタックスを有効にした場合，``DOM Create XML element``の速度が以前よりもずっと遅くなりました。

* ACI0100916 ``OBJECT SET SCROLLBAR``でピクチャオブジェクトのスクロールバーを表示した場合，フォームのページを切り替えると，スクロールバーが非表示に戻りました。

* ACI0100915 Mac版のみ。4D for iOSの同期処理中にアプリがクラッシュすることがありました。

* ACI0100908 ``FTP_Receive``のパラメーターにファイル名を渡した場合，相対パスとして処理されず，エラー``-48``が返されました。

* ACI0100902 コレクション型リストボックスの``On Data Change``イベントでは``This``が使用できませんでした。

* ACI0100898 ``VP SET FORMULA``でフォーミュラを設定したセルに対して``VP COLUMN AUTOFIT``を使用した場合，``autoFit``が適用されませんでした。

* ACI0100897 非常に長い件名のメールをトランスポーターで送信した場合，空白文字が挿入されました。ヘッダーエンコーディング``mail mode UTF8 in base64``で問題が発生します。

* ACI0100896 プロジェクトモードのみ。マークダウン形式のコメント内に記述したコード（言語は未指定）が4Dコードブロックとして表示されました。

* ACI0100894 エンティティセレクション型リストボックスのデータソースをクエリし，エンティティセレクションのサイズを減らした場合，``LISTBOX SELECT ROWS ``が正しく動作しませんでした。

* ACI0100893 「外部ファイルのユーザー設定」が有効にされている場合，サーバー側の管理画面でクライアントをドロップすることができませんでした。

* ACI0100961 タブコントロールにアイコンが表示されている場合，タイトル文字列の直下ではクリックイベントが発生しませんでした。

* ACI0100890 32ビット版で作成されたラベル定義ファイルをラベルエディターでロードしようとした場合，エラー``-9930``が返されました（``Editor_ON_DATA_CHANGE``コンポーネントメソッドの``286``行目）。ACI0096880が修正されたことによる副作用のようです。

* ACI0100966 Mac版のみ。4D for iOSで設定した「パラメーター無し」アクションのスコープを後から変更することができませんでした。追加アクションのスコープはテーブル，更新アクションのスコープはカレントエンティティであり，他に選択肢はありません。「パラメーター無し」アクションは，どちらでも良いはずです。

* ACI0100953 Mac版のみ。4D for iOSのクエリフィルターが設定されたデータクラスに対し，１対Ｎリレーションでアクセスした場合，フィルターが適用されず，すべてのレコードが表示されました。

* ACI0100932 プロジェクトモードのみ。オブジェクトの「クラス」プロパティだけを変更した場合，JSONフォームの配置スタンプが更新されませんでした。

* ACI0100797 WebサーバーにHTTPの``PATCH``メソッドを送信した場合，HTTPヘッダーの``X-METHOD``フィールドに値がセットされませんでした。

* ACI0100795 XPathで指定した要素名にハイフン（``-``）記号が含まれている場合，``DOM Find XML element``でその要素ノードをみつけることができませんでした。ハイフン（``-``）記号がマイナス演算子として評価されるためです。

* ACI0100794 自己署名証明書など，信頼されていない証明書を使用しているHTTPSページはCEF版の統合Webエリアに表示されませんでした。

* ACI0100793 １対Ｎのリレーション属性に対して``AND``と``OR``条件を組み合わせてORDAクエリを実行した場合，結果が正しくありませんでした。

* ACI0100790 プロジェクトモード。フォームのプロパティを変更した場合など，特的の条件では，ドキュメントが更新されたことを示すアイコン（Macでは閉じるボタンのスポット，Windowsではアスタリスク記号）が表示されませんでした。プロパティリストを操作した後，フォームエディターをクリックすれば，アイコンが表示されます。

* ACI0100789 エンティティセレクション型リストボックスの「選択された項目」プロパティの管理が正しくありません。たとえば，すべての行を選択した後，行の選択を解除した場合，「選択された項目」から対応する行が除かれませんでした。

* ACI0100788 ``TRANSFORM PICTURE``に``Crop``オプションを指定した場合，特定の画像でアプリケーションがクラッシュしました。内部的な計算で座標が負の値がなる場合に問題が発生します。

* ACI0100783 プロジェクトモードのみ。OEMライセンスを使用し，``IsOEM``キーを``True``に設定してサーバーアプリケーションをビルドした場合，データファイルを開こうとするとエラーが返されました。バイナリモード，スタンドアロン版，あるいは標準ライセンスであれば，問題ありません。

* ACI0100782 リモートデータストアセッションが開かれている状況で``QUIT 4D``を実行した場合，サーバーがハングすることがありました。進行中のセッション数が``2``個であれば問題ありません。``3``個であれば，稀にハングします。進行中のセッション数が``6``個の場合に問題が発生します。

* ACI0100781 ``MSG_Extract``で取り出した添付ファイル名のアポストロフィ記号がデルタ（``∆``）記号になりました。

* ACI0100779 テーブルの暗号化を有効にした時点で該当するテーブルにレコードが存在しなかった場合，そのテーブルにレコードを追加することができませんでした。

* ACI0100777 非常に長いループ処理で文字列演算子の``+``を使用し，結合した文字列の自己代入を繰り返した場合，アプリケーションがクラッシュしました。バッファサイズが指数関数的に確保されているようです。無事にループを脱出すれば，占有メモリは元に戻ります。

* ACI0100775 プロジェクトモードのみ。``Administrator``ユーザーは，他のユーザーを削除することができませんでした。``Designer``が削除したユーザー以外は削除できるべきです。

* ACI0100774 Windows版のみ。統合CEF版Webエリアに画像ファイルを表示した場合，リストボックスからWebエリアにフォーカスが移動しました。リストボックスに表示された画像ファイルのパスを矢印キーで操作するようなインタフェースが正しく機能しません。システムWebエリアであれば，問題ありません。

* ACI0100773 ``POP3 Transporter``の``checkConnection()``メソッドを続けてコールした場合，すでに接続が確立されているか確認するために``NOOP``リクエストが送信されませんでした。接続が再確立されました。

* ACI0100768 ``DOM Find XML element``で使用できるXPathシンタックスが拡張されましたが，``contains()``関数がサポートされていませんでした。

* ACI0100760 4D View Proエリアを表示した直後のタイプ入力に対し，``On After Edit``イベントが発生しませんでした。Macの場合，アプリケーションを再起動した後は問題が発生しません。Windowsの場合，最初に入力したのが数字であれば，問題は発生しません。いずれのプラットフォームでも，最初の文字をフォーミュラバーから入力したのであれば，問題は発生しません。また，セルをダブルクリックsて入力モードに移行したのであれば，問題は発生しません。セルを選択した状態から直接タイプ入力を開始した場合に問題が発生します。

* ACI0100757 4D Write Proドキュメントの冒頭にテキストをタイプ入力した場合，キー操作から文字の表示まで少しの遅延がありました。ドキュメントの終わりのほうであれば，問題ありません。

* ACI0100756 ``OB Is empty``にフォーミュラオブジェクトを渡した場合，``True``が返されました。

* ACI0100749 クライアント/サーバー版のみ。クライアント側のコンポーネント内でORDAを実行し，エンティティセレクションを作成した場合，``null``が返されました。ローカルモードおよびサーバー側コードでは問題ありません。

* ACI0100748 ``SET DATABASE PARAMETER``でセレクター``34``を``0``にセットした場合，``Get database parameter``から返される値が更新されませんでした。

* ACI0100747 ``DOM Create XML element``で要素を追加した場合，逆順に要素が作成されました。

* ACI0100741 プロジェクトモードのみ。デーファイルと同じ場所にユーザー設定が存在する場合（つまりストラクチャとデータが別々のフォルダーに存在する場合），バックアップからデータベースを復元すると，アプリケーションがクラッシュしました。

* ACI0100740 4D Write ProドキュメントをHTML形式でエクスポートした場合，段落全体に適用された下付き文字や上付き文字，段落中の特定の単語にだけ適用された背景カラーが正しく出力されませんでした。

* ACI0100735 クラスのコンストラタよりもファンクションを記述した場合，そのクラスをインスタンス化してファンクションを実行するとエラーが返されました。

* ACI0100734 ``SET ALLOWED METHODS``で許可したメソッドが4D View Proのツールバーに数式として表示されませんでした。

* ACI0100732 4D Write ProドキュメントをMicrosoft Word形式でエクスポートした場合，経線で区切られた段落がひとつの段落に結合されました。

* ACI0100731 エンティティセレクション型のリストボックスビルダーに表示されるテーブルリストが正しくありませんでした。RESTリソースとして公開されているだけが表示されました。``ds``コマンドでアクセスできるテーブル，つまりORDAの条件に適っているテーブルのリストが表示されるべきです。

* ACI0100727 v16からv17に変換されたストラクチャの場合，フォームエディターのプロパティリストでチェックボックスの標準アクションを``accept``に設定することができました。

* ACI0100726 新ネットワークレイヤーのみ。新規ユーザープロセスでダイアログを実行しているクライアントのネットワーク接続が不意に切断された場合，およそ``30``秒後にエラーメッセージが表示され，およそ``60``秒後にサーバー側で当該クライアントの「アプリケーションプロセス」が消滅するのが確認できますが，ユーザープロセスは残されたままの状態になります（およそ``2``時間後に処分されます）。このタイミングでネットワーク接続が回復し，クライアントをサーバーに再接続した場合，以前のセッションやプロセスが消えず，クライアント接続ライセンスが余分に消費されました。接続が失われたクライアントのプロセスが「延期」状態になった後に再接続すれば，問題ありません。

* ACI0100725 ``SMTP Transporter``でメールを送信した場合，``\r\n``文字列がQuoted-Printableエンコーディングされて``=0D=0D``になりました。大概のメールクライアントでは問題ありませんが，OutlookまたはOutlook Expressではメール本文の表示が崩れました。

* ACI0100723 4D Write Proドキュメントにページ番号が挿入されている場合，ページの下方向スクロール速度が遅くなることがありました。``500``ページ規模のドキュメントで問題が発生します。

* ACI0100722 [``File``](https://doc.4d.com/4Dv18/4D/18/File.301-4506034.ja.html)に定数（例：``Build application log file``）を渡し，そのファイルが存在しなかった場合，「引数番号1が無効です」というエラーが返されました。ファイルが存在しないだけであり，パラメーターが間違っているわけではないので，このようなエラーが返されるべきではありません。

* ACI0100716 畳まれた``Case of``ブロックの行の終わりにキャレットを移動し，``return``キーを入力したから「取り消し」操作をした場合，``End case``キーワードが消えました。

* ACI0100715 ORDAでエンティティの１対Ｎリレーションを使用した場合，メモリーリークが発生しました。シングルユーザー版とクライアント/サーバー版の両方で問題がありますが，サーバー側のほうが顕著でした。

* ACI0100708 Windows版のみ。サービス起動中のサーバーの自動アップデートが失敗しました。アップデーターのサービス名が間違っているためです。"4DS "+ストラクチャ名という固定値が使用されていますが，ストラクチャ名とサービス名が一致するとは限りません。

* ACI0100707 4D WriteドキュメントをWrite Proに変換した場合，特定の数式が変換されずに失われました。

**注記**: リテラル文字列内でダブルクオート記号（``"``）がバックスラッシュ記号（``\``）でエスケープされているような数式で問題が発生しました。

* ACI0100706 ピクチャ演算子``*|``をコンパイルするとシンタックスエラーが返されました。

* ACI0100704 4D for iOSの「データ」セクションで「MobileApps」フォルダーの中にない``key.mobileapp``ファイルをプロダクションサーバーのデータファイルとして選択した場合，「プロダクションサーバーが利用できません」というエラーでビルドが中止されました。「MobileApps」フォルダーの中にあるファイルであれば，問題ありません。

* ACI0100698 macOS 10.14のみ。３Ｄチェックボックスの「開示ボタン」をクリックした場合，``Form event code``コマンドが正しいイベントを返しませんでした。10.15では問題ありません。

* ACI0100696 Windows版のみ。画面の下方で日本語を入力した場合，変換プログラムの候補リストが入力中の文字列を覆い隠してしまいました。ポップアップがテキスト入力エリアの（上端ではなく）下端から上に向かって描画されるためです。

* ACI0100687 Mac版のみ。4D for iOSの「プロダクションサーバーデータファイル」を有効に設定した場合，``Mobileapps``フォルダーに``key.mobileapp``ファイルが作成されませんでした。ACI0100704（修正済み）と関連のある問題です。

* ACI0100681 特定の条件が揃った場合，SQLの``LEFT OUTER JOIN``を実行すると，同じレコードが``2``個，返されました。

* ACI0100680 Retina高解像度ディスプレイとそうではないディスプレイの間でウィンドウを移動した場合，フォームの背景が表示されなくなりました。

* ACI0100678 ``MAIL Transporter``の``htmlBody``よりも前に``textBody``をセットした場合，受診者のメールクライアントがHTMLメールよりも標準テキストメールのほうを優先的に表示しました。逆の順序でプロパティをセットすれば，問題ありません。

* ACI0100668 Mac版プロジェクトモードのみ。ツールボックスのメニュータブを開いた状態で，別のアプリケーションを最前面に移動してから4Dに復帰した場合，ツールボックスの右側に表示されるメニューバーの内容がおかしくなりました。
