---
layout: post
title: "Write ProでEMF画像は印刷できない"
date: 2019-10-23 12:00:00
categories: 仕様
tags: printing
---

4D Write Proは，印刷バックエンドにDirect2Dテクノロジーを使用しています。``.emf``イメージのレンダリングには，GDIコンテキストが必要なため，Write Proでは印刷することができません。これは仕様です。ベクター画像をドキュメントに挿入したい場合，旧来の``.emf``形式ではなく，標準的な``.svg``形式を使用してください。

Microsoftは，画面と印刷でレンダリングが一致することを謳っていません。それは歴史的にAppleが強いとされる分野であり，グラフィック関係者がMacを選択する理由のひとつでした。Windowsは，基本的に画面上と印刷ではまったく違う処理をしています。

v12以前のWindows版4Dは，画面と印刷の両方にAlturaライブラリを使用しています。Alturaは，Macのエミュレーションであり，Windows本来の96 DPIではなく，72 DPIの描画をします。画面と印刷の差は少なかったかもしれませんが，ネイティブ描画ではなく，Windows版の出力は必ずしも理想的ではありませんでした。

v13以降のWindows版4Dは，画面にDirectXを採用するようになりました。ハードウェアアクセラレーターを使用した高速なレンダリングであり，全体的に従来よりも美しい出力が可能になっています。一方，印刷には，当時のプリンタードライバーで主流だったGDIが使用されています。このバージョンでは，画面と印刷でかなりの差があるかもしれません。

v17のWindows 64ビット版は，画面と印刷の両方にDirectXを使用しています。画面と印刷の差は再び縮まったと思われますが，Macとは違い，システムレベルで一致が保証されているわけではありません。

[``SET PRINT OPTION``](https://doc.4d.com/4Dv17/4D/17.3/SET-PRINT-OPTION.301-4621729.ja.html)の``Legacy printing layer option``を使用すれば，強制的に以前（32ビット版）のGDIエンジンで印刷を実行することができます。v13に近い出力が得られるかもしれませんが，画面と印刷の違いは，プリンタードライバーに依存します。たとえば，Microsoft Print to PDF driverは，DirectX用に設計されており，GDIモードのサポートは貧弱です。反対に，GDIのほうが「高品質な」PDFドライバーもあります。いずれにしても，GDIモードの印刷は，互換性のために提供されているオプションであり，長期的に保証できるものではないため，使用はできる限り控えるようにしてください。
