---
layout: post
title: "`[Gmail]/All Mail`メールボックスとIMAP"
date: 2021-02-21 12:00:00
categories: 仕様
tags: 18r5 imap
---

IMAPの`DELETE`コマンドを`[Gmail]/All Mail`メールボックスに送信することはできません。このメールボックスには実体がないためです。`DELETE`コマンドは`INBOX`のようなメールボックスに送信するようにしてください。

`[Gmail]/All Mail`メールボックスに対して`COPY`コマンドを実行することはできますが，注意がひ必要です。サーバーが内部的に`EXPUNGE`を実行するため，結果的に`MOVE`を実行したような状態になります。`COPY`コマンドは`INBOX`のようなメールボックスに対して実行するべきです。

RFC3501によれば，IMAPの`STORE \Deleted`は後に`EXPUNGE`コマンドを実行したとき（あるいは接続を閉じた時）にメッセージを削除するよう，マークする働きがあります。メールボックスを移動したときにメッセージが削除されるわけではありません。
