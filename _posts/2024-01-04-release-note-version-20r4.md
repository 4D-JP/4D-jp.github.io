---
layout: fix
title: "4D 20r4 修正リスト"
date: 2024-04-22 08:00:00
categories: 修正リスト
tags: 20r4
build: 100333
version: "20r4"
permalink: /2024/4/:slug/
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}} 

* ACI0104755 Qodly Studioの*$shared* 仮想フォルダーが*webAdmin* ポートを介して配信されませんでした。ACI0104622が修正されたことによる副作用です。起動時に*webAdmin* サーバーを開始していれば，問題ありません。

* ACI0104731 `var`シンタックスで変数の宣言と初期化を記述し，タイプとして小文字の`4D.folder`または`4D.file`を記述した場合，コンパイラーが問題を検出しませんでした。変数の宣言だけであれば，未知のクラスであるという警告が表示されます。ACI0104606が修正されたことによる副作用です。

* ACI0104700 `collection.multiSort()`の速度が芳しくありませんでした。コレクションを配列に変換して並び替えを実行し，コレクションに戻したほうがずっと高速です。

**注記**: マルチソートの仕組みが見直され，パフォーマンスが向上しました。配列とコレクションは違うものなので，単純な比較はできませんが，修正により，配列コマンドとの速度差は最悪でも`1.5`から`2`倍程度です。

* ACI0104696 可変長引数メソッドの呼び出しが存在する場合，シンタックスチェックに余計な時間がかかりました。

* ACI0104737 Mac版のみ。20r4でビルドしたクライアントがQUICレイヤーで20r5のサーバーに接続した場合，自動アップグレードに失敗してクライアントがクラッシュしました。

* ACI0104733 すトアドプロシージャー実行中に`Count users`を使用した場合，実際のユーザー数に`1`を加えた値が返されました。

**注記**: 仕様が見直され，ドキュメントが改訂されました。

* ACI0104438 複数のネットワークカードが存在する環境でWebサーバーの待ち受け固定IPアドレスにドメイン名を設定した場合，Webサーバーに`https:`で接続するとステータスコード`409`が返されました。`http:`であれば問題ありません。

* ACI0104721 クライアント/サーバー版のみ。クライアント側で`Set user properties`で実行した場合，ハッシュされたパスワードの代わりに`*`という文字が*directory.json* に書き込まれることがありました。

* ACI0104710 Write Proドキュメントの小数点区切りを「なし」に設定した場合，数値が小数点のあるべき位置で揃いませんでした。

* ACI0104646 Mac版のみ。アプリケーションの設定ダイアログの「閉じる」ボタンをクリックしてもウィンドウが閉じられませんでした。

**注記**: 修正により，設定ダイアログの「閉じる」ボタンはグレーアウト表示されるようになりました。*escape* キーまたはキャンセルボタンでウィンドウを閉じてください。これにはACI0104310の修正が関係しています。ドキュメントには[`Open Form window`](https://doc.4d.com/4Dv20R3/4D/20-R3/Window-Types.300-6532177.ja.html)コマンドの*Movable form dialog box (5)* タイプのウィンドウは「クローズボックスまたは同等の機能を持てる：はい」となっていますが，固定サイズのフォームは「閉じる」「最大化」「最小化」ボタンが表示されませんでした。ACI0104310が修正されたことにより，そのようなフォームでも「閉じる」ボタンが表示されるようになりましたが，ドキュメントでは「クローズボックスまたは同等の機能を持てる：いいえ」となっている[`Open window`](https://doc.4d.com/4Dv20R3/4D/20-R3/Window-Types-compatibility.300-6532197.ja.html)コマンドの*Movable dialog box (5)* も「閉じる」ボタンが表示されるようになりました。今回の修正は，`Open window`の古い動作を復元する（ドキュメントに合わせる）というものです。

* ACI0104693 TLS接続が失われた場合，診断ログに*DoWrite: failed to write* というエラーが延々と出力されました。同時にメモリーリークも発生しました。

* ACI0104688 システム言語が日本語以外に設定されているプラットフォームで日本語のデータベースプロジェクト（カタログの`collation_locale`が`ja`）にコマンドライン引数の`--create-data`を渡して起動した場合，エラー`126`が返されました。

**注記**: エラーは*MeCab* ライブラリがみつからないことを意味しています。修正により，このエラーは無視されるようになりました。

* ACI0104713 クライアント/サーバー版のみ。クライアント側で*Designer* のパスワードを設定した後，別のユーザーに切り替えてから*Designer* に戻そうとした場合，システムパスワードが変更できないというエラーが返されました。再度ログインすれば問題ありません。

* ACI0104625 `HTTPRequest`のリクエストボディにコレクション型を使用することができませんでした。

* ACI0104652 Windows版のみ。Webエリア上に表示したポップアップウィンドウの外をクリックしてもウィンドウが閉じられませんでした。

* ACI0104689 Mac版のみ。システムまたはアプリの言語設定が日本語設定されていない場合，日本語名のフォームメソッドをApple Siliconターゲットに対してコンパイルすることができませんでした。

* ACI0104621 「格納場所」が「データファイルの外」かつ「ヌル値を空値にマップ」が設定されたBLOB型フィールドにデータを代入した場合，MSCのデータ検証で無効なデータフィールドサイズが検出されました。

* ACI0104692 「格納場所」が「データファイルの外」かつ「内部ストレージの最大バイト」が`0`以外に設定されたBLOB型フィールドに最大バイトを下回るサイズのデータを代入した場合，データファイルに保存されませんでした。ACI0104621が修正されたことによる副作用のようです。

* ACI0104702 *4D Helper Tool* がバックグランド項目にインストールされませんでした。ファイル名*com.4D.Helper* ではなく，*com.Helper* となっているためです。

* ACI0104675 再帰的なオブジェクト参照が含まれるコレクションに対して`Collection.equal()`を使用した場合，アプリケーションがクラッシュしました。

* ACI0104608 *NetKit* でメールを送信した場合，`.bcc`プロパティが無視されました。

**注記**: *NetKit* は内部的にJMAP形式のメールをMIMEに変換しています。メールサーバーはMIMEからBCCヘッダーを削除するように設計されているため，MIME変換時に`.bcc`プロパティを削除する必要はないと判断しました。

* ACI0104536 インデックスクエリを実行するとサーバーが突然に終了することがありました。

**注記**: DB4Dワーカーの内部的なリストを更新する仕組みが見直されました。内部的なリストが正しく管理されていないと，ワーカー数が理論的な上限である`32767`に達し，ある時点で新規の接続が使用済みのワーカーによって処理されるかもしれません。そのようなワーカーが，アイドル時間タイムアウトによるデータベースコンテキストの延期と再開を繰り返していると，やがて同一のデータベースコンテキストが同時に別々のクエリを実行してクラッシュを引き起こす可能性がありました。

* ACI0104639 クイックレポートエディターで保存したファイルを削除した場合，レポートがメモリに残っているためにクイックレポートエディターで再表示することができますが，その後，エディターを閉じるときに表示されるプロンプトで「保存しない」ボタンをクリックした場合，エラー`-43`（ファイルがみつかりません）が返されました。

**注記**: 修正により，必要に応じてレポートファイルが復元されるようになりました。

* ACI0104606 変数の宣言と同時に値を代入する記述に`$val : Integer:="text"`のようなタイプの不一致があっても，コードライブチェッカーに検出されませんでした。宣言と代入を別々の行に記述すれば，エラーが検出されます。

* ACI0104522 プロジェクトモードのみ。テーブル間にリレーションを設定し，ストラクチャエディターのリレーションインスペクターで「自動ワイルドカードサポート」を有効にした場合，「ワイルドカード」フィールドを設定することができますが，選択したフィールドがインスペクターの表示に反映されませんでした。カタログ自体は更新されています。

* ACI0104618 `.certificatesFolder`プロパティに`4D.Folder`オブジェクトを設定して`4D.HTTPRequest`を使用した場合，アプリケーションがクラッシュしました。パス文字列を設定すれば問題ありません。

**注記**: 全般的なメモリーリークを解消するための修正（ACI0104402）が関係していました。

* ACI0104571 プラグインSDKの`PA_GetVariable`および`PA_SetVariable`の速度に問題がありました。過去バージョンとの比較で`10`から`20`倍程度パフォーマンスが低下しています。

**注記**: 本来，プラグインにテキストを渡すときには参照カウントをインクリメントするべきですが，過去バージョンのプラグインAPIはテキスト配列の各要素に対してこの操作をしていませんでした。4D 20でパフォーマンスが低下したのは，この問題が修正されたためです。さらに，今回の修正により，`EX_GET_VARIABLE(19)`エントリーポイントが改良されました。`EngineBlock`構造体の`fLongint`フィールドに値`CNST`を渡すことにより，テキストがコピーされないようにできます。プラグイン側でテキスト配列の値を更新するのであれば，この新しいオプションは使用しないでください。

* ACI0104505 特定のストラクチャでデザインモードのファイルメニューからカタログをHTML形式でエクスポートした場合，アプリケーションが終了しました。

**注記**: HTMLの文字セットを`UTF-8`にセットするための`<meta>`タグも追加されました。

* ACI0104631 Mac版のみ。フィールドに`+=`演算子でポインターの逆参照を加算した場合，Apple Siliconターゲットのコンパイラー（*clang* ）がエラーを返しました。フィールドの代わりに変数を使用すれば問題ありません。また`+=`の代わりに`:=`および`+`演算子を使用すれば，問題ありません。

```4d
[Batch]Data1+=($varPtr->)
```

* ACI0104628 クライアント/サーバー版のみ。データストアクラスのメンバー関数で`Current user`を使用した場合，カレントユーザーおよびエイリアスに*Designer* が返されました。

**注記**: サーバー側のDB4Dプロセスにカレントユーザーの概念はありません。

* ACI0104619 クライアント/サーバー版のみ。`EntitySelection.fromCollection()`を実行した場合，既存のエンティティが更新される代わりに新規エンティティが作成されました。

* ACI0104541 リストボックスの自動行高プロパティを有効に設定した場合，画面に表示されていない行の分までメタ情報式が評価され，パフォーマンスが劇的に低下しました。

* ACI0104494 クライアント/サーバー版のみ。特定のコマンドをタイプアヘッド入力中にメソッドエディターがクラッシュしました。すべてのストラクチャで再現するわけではありません。

* ACI0104616 `Get table fragmentation`から返される値が正しくありませんでした。MSCの情報も（内部的に同じコマンドを使用しているため）間違っています。

* ACI0104610 ヘッドレスモードのみ。[レベル５のメッセージ（エラーではなく警告）](https://developer.4d.com/docs/ja/Debugging/debugLogFiles/)がコンソールではなくダイアログに出力されました。

* ACI0104439 クライアント/サーバー版のみ。プライマリーキー値にスラッシュ記号（`/`）が含まれているエンティティのリレーション属性に対してORDAの`orderBy()`関数を実行した場合，エラー`1804`および`1500`が返されました。リモートデータストアでも同じ現象が再現します。

* ACI0104551 フランス語版のみ。スプレッドシートをView Proにインポートした場合，`CNUM`関数が小数点（フランス式はカンマ記号）を正しく処理しませんでした。セルに値を手入力すれば正しく表示されるようになります。

* ACI0104601 *.4qs* ファイルに記述した*qodlyscript* が有効なコードであっても，LSP（言語サーバープロトコル）がエラーを返すことがありました。`.query()`や`.all().orderBy().slice()`で問題が再現します。

* ACI0104599 `Create deployment license`にスタンドアロン版のライセンス（`4UUD`または`4UOE`）を渡した場合，エラーが返されました。ACI0104384が修正されたことによる副作用のようです。

* ACI0104582 フィールドの「重複不可」属性が無効に設定されたストラクチャファイルでフィールドの「重複不可」属性が有効に設定されていたデータファイルとインデックスファイルを開いた場合，データファイルの設定でストラクチャファイルが上書きされ，既存のレコードと値が重複するフィールドを保存することができなくなりました。

* ACI0104565 複数のページにわたって表示されるような分量のテキストをWrite Proドキュメントのテーブル（表）の行またはセルに設定した場合，最終ページのテキストが完全に表示あるいは印刷されないことがありました。テキスト全体のコピーはできるので，表示上の問題です。旧式プリントレイヤーで顕著ですが，標準プリントレイヤーでも再現します。

**注記**: 旧式プリントレイヤーで印刷ジョブを開始してから`WP PRINT`を実行した場合，Write Proは旧式プリントレイヤーでドキュメントをレンダリングを試みますが，Write Proは標準プリントレイヤー（WindowsであればDirect2D）専用であることに留意してください。

* ACI0104561 Windows版のみ。*Adobe Acrobat Pro* をカレントプリンターに設定して印刷した場合，アプリケーションがクラッシュしました。

**注記**: プリントドライバー側の問題です。印刷ジョブ名が設定されていないために`PSCRIPT5.DLL`がスタックオーバーランを起こしています。`OPEN PRINTING JOB`で明示的にプリントジョブを管理すれば，印刷セッション名が設定されるので，クラッシュは発生しません。あるいは，`SET PRINT OPTION`の*Spooler document name option* でPDFファイル名を明示的に設定することもできます（ファイル名がデフォルトの印刷セッション名になるため）。不具合は修正されましたが，印刷コマンドでPDFファイルを出力する場合は常にスプーラードキュメント名を設定することが勧められています。

* ACI0104517 コレクション型のリテラル記法に関数オブジェクトの呼び出しを記述した場合，シンタックスエラーになりました。

```4d
$obj:={attr1: [$class.myFunction()]}  
```

* ACI0104507 Mac版のみ。`MESSAGE`コマンドがダークモードに対応していませんでした。

* ACI0104389 オブジェクト型のリテラル記法にコレクション型のリテラル記法を記述した場合，シンタックスエラーになりました。

```4d

var $toto : Object:={id: 10}
$test:={addLabelIds: [$toto.id]}
```

* ACI0104584 `HTTPRequest`で送信したリクエストの*Content-Type* ヘッダーには，常に*; encoding=utf8* という情報が追加されるため，この形式のヘッダー情報に対応していないAPIをコールすることができませんでした（例: Claris FileMaker Server）。

* ACI0104567 *NetKit* コンポーネントの*OAuth* オブジェクトを`JMAP`または`MIME`メール形式でインスタンス化した場合，メールのフラグを既読/未読に設定することができませんでした。`Microsoft`メール形式であれば問題ありません。

**注記**: メッセージの更新をサポートしているのは`Microsoft`メール形式だけです。修正により，必要に応じてメッセージ形式が一時的に変換されるようになりました。

* ACI0104583 複数のプロセスで同時に`Compile project`を実行した場合，アプリケーションがクラッシュしました。

* ACI0104569 Mac版のみ。Write Proドキュメントのカスタム用紙サイズ設定が適用されませんでした。

* ACI0104492 サーバーと通信中のプロセスをクライアント側で終了した場合，サーバーとの接続が切断されました。

* ACI0104586 Mac版のみ。システムのロケールがベルギーのオランダ語（`nl-be`）に設定されている場合，`String`のフォーマット文字列`dd/MM/yyyy`がエラーを返されました。

* ACI0104581 Windows版のみ。`100%`よりも高いスケールにディスプレイを設定した場合，タブコントロールがクリック操作に反応しませんでした。

**注記**: 高解像度ディスプレイを正しくサポートするためには，互換性オプション「フォームでのテキストレンダリングではDirectWrite を使用する」を有効にする必要があります。修正により，オプションが設定されていなくてもタブコントロールがクリックできるようになりましたが，その場合，テキストレンダリングのクオリティが低下することに留意してください。

* ACI0104579 プロジェクトモードのみ。ブール型フィールドに対して`OBJECT DUPLICATE`を実行した場合，何も起きませんでした。

**注記**: プロジェクトモードにブール型フィールドというフォームオブジェクトは存在しません。ブール型フィールドをデータソースとするラジオボタンまたはチェックボックスがあるだけです。

* ACI0104562 メソッドエディターのコンテキストメニューでローカル変数の名称を変更した場合，複数行にわたって記述されたコードに看過されることがありました。

* ACI0104549 新ネットワークレイヤーで「ドメインサーバーによるユーザーの認証」を有効にした場合，メモリーリークが発生し，クライアントがフリーズすることがありました。ACI0103215が修正されたことによる副作用です。

* ACI0104529 Write Proエリアで行末にソフトブレークが存在する行に日本語のスタイル付きテキストをIMEで入力した場合，`1`行に`1`文字ずつ文字が表示されました。たとえば，メソッドエディターのリッチテキストをWrite Proエリアにペーストするとそのような行ができます。あるいは，*shift*+*return* に続けて*return* を入力することにより，ソフトブレークだけの空行ができるので，そこにIMEで日本語を入力しても再現します。

* ACI0104590 Mac版のみ。ラジオボタンまたはチェックボックスに対して`BEST OBJECT SIZE`を使用した場合，正しい値が返されないことがありました。オブジェクトの幅が数ピクセル不足しているため，ボタンタイトルが途切れて表示されます。フォームエディターの「自動サイズ」も同様です。

**注記**: Mac版のラジオボタンとチェックボックスには，Regular・Small・Miniというバリエーションがあり，オブジェクトの高さによって表示されるタイプが決まります。オブジェクトの最適サイズを計算するためには，表示されるラジオボタンまたはチェックボックスのサイズを特定する必要がありますが，タイトルのフォントではなく，オブジェクトの高さを判定基準にしていたために計算が合わないことがありました。仮にオブジェクトの高さが`10`ピクセル，タイトルのフォントの高さが`24`ピクセルだった場合，オブジェクトの高さを基準にすれば，タイプはMini（`11x11`）ですが，フォントを基準にすれば，タイプはSmall（`14x14`）になります。SmallであるべきところをMiniの幅で最適サイズを計算すると，タイトルを表示するエリアの幅が`3`ピクセル足りません。つまり，タイトルが完全に表示されるかどうかは，フォントの高さとオブジェクトの高さに左右されました。

* ACI0104553 ラジオボタンとして表示されるように設定されたブール型フィールドを配置したフォームをプロジェクトに変換した場合，ボタンタイトルが途切れて表示されることがありました。

* ACI0104530 Mac版のみ。自動アップデートを実行するための*Updater.app* がクラッシュしました。

* ACI0104231 *Web Folder* は存在しないものの，*qodlyApp.json* が存在する状態でWebサーバーを起動した場合，ランタイムエラーが返されました。

* ACI0103757 ピボットテーブルを含むView Proスプレッドシートを`.xlsx`形式でエクスポートしてExcelで開いた場合，ナビゲーションバーが表示されませんでした。オフスクリーンエリアで`VP EXPORT DOCUMENT`を使用した場合に問題が再現します。ユーザーインタフェースからエクスポートした場合は問題ありません。

* ACI0104574 `Open datastore`で*Qodly* からリモートデータストアに接続した場合，プロセス毎にセッションクッキーが発行され，クライアント接続ライセンスが消費されました。

* ACI0104558 フォームに２個の統合Webエリアを配置し，`WA SET PAGE CONTENT`で空のページを表示しようとした場合，アプリケーションがクラッシュしました。URLを`about:blank`に設定すれば問題ありません。いずれかのWebエリアをシステム版に変更すれば問題ありません。

* ACI0104515 `Open datastore`で4D Serverのユーザー名とパスワードを使用することができませんでした。*On REST Authentication* データベースメソッドで受信したパスワードハッシュを検証することができません。

**注記**: [4D 19 R3以降，*directory.json* の仕様が変わり，bcryptハッシュが使用されるようになった](https://blog.4d.com/ja/bcrypt-support-for-passwords/)ことが関係しています。修正により，パスワードはハッシュされずに標準テキストで送信されるようになりました。[*On REST Authentication*](https://doc.4d.com/4Dv20/4D/20.2/On-REST-Authentication-database-method.301-6720994.ja.html) データベースメソッドで[`Validate password`](https://doc.4d.com/4Dv20/4D/20.2/Validate-password.301-6721229.ja.html)を使用できるようにするためです。その場合，`Open datastore`の接続パラメーターの`tls`オプションを`True`に設定することが強く勧められています。さらに，接続パラメーターの`passwordAlgorithm`プロパティを`4d-rest-digest`に設定することにより，bcryptではなく，過去バージョンと同じMD5系のハッシュを送信できるようになりました。これは*On REST Authentication* データベースメソッドで`Validate password`を使用するための互換性オプションです。RESTでサーバーにアクセスできるユーザー＆グループを**ストラクチャ設定**で管理する場合（*On REST Authentication* データベースメソッドを作成しない場合），`passwordAlgorithm`プロパティは指定しないでください。

<i class="fa fa-external-link" aria-hidden="true"></i> [ストラクチャー設定を使用する](https://developer.4d.com/docs/ja/REST/configuration#ストラクチャー設定を使用する)

* ACI0104341 ORDAの`entity.clone()`を実行した場合，エンティティがロックされました。

* ACI0104572 *Write Pro Toolbar* の印刷設定ボタンのヘルプTipsにXLIFF参照がそのまま表示されました。

* ACI0104550 `MIME-Version`や`Date`など，既定のヘッダーをメールオブジェクトで設定して`SMTP New transporter`で送信した場合，両方のヘッダーがMIMEに含まれました。一部のメールクライアントはヘッダーの重複に対応していないため，表示に問題がありました。いずれにしても，カスタムヘッダー値だけが送信されるべきです。

* ACI0104537 デザインモードで未使用のローカル変数を検索した場合，宣言と同時に初期化をしている行（したがって未使用ではない）がヒットしました。

* ACI0104533 *Client Web Application Expansion* ライセンスがインストールされていないクライアントで*NetKit* を使用することができませんでした。4D 20 LTSでは問題ありません。

* ACI0104511 エンティティを返すメンバー関数の呼び出しに続けてオブジェクト記法で属性パスを記述した場合，シンタックスチェックでエラーが返されました。エンティティを一旦ローカル変数に代入すれば問題ありません。

* ACI0104267 インタープリターモードのみ。`SET DATABASE PARAMETER`の*Max concurrent Web processes* などのオプションを設定した場合，インタープリターモードであってもWebプロセスがプリエンプティブスレッドで実行されるようになりました。Webサーバーを再起動すれば元の動作に戻ります。`WEB SET OPTION`またはデータベース設定でオプションを設定すれば問題ありません。

* ACI0104545 不正なコンパイル指示コメント（`//%W-550.100`）をメソッドに記述した場合，コンパイラー/シンタックスチェックがクラッシュしました。

* ACI0104539 Windows版のみ。Plugin APIの`PA_GetMainWindowsHWND`をプリエンプティブスレッドから実行した場合，アプリケーションがクラッシュすることがありました。

**注記**: 修正により，クラッシュは回避されるようになりましたが，プリエンプティブスレッドから当該APIを使用してはいけないことには変わりません。

* ACI0104528 Windows版のみ。統合Webエリアが配置されたフォームを最前面に移動するためには，ウィンドウのタイトルバーを`2`回クリックする必要がありました。

* ACI0104525 何らかの理由でリストボックスのヘッダーまたはフッターのオブジェクト名が空に設定されている場合，`METHOD GET PATHS`を実行するとアプリケーションがクラッシュしました。

* ACI0104463 リストボックスセルのスタイル付きテキストの先頭文字を選択し，コンテキストメニューからスタイルを適用した後，*command*+`A`でテキスト全体を選択した場合，スタイルがテキスト全体に適用されました。

* ACI0104427 4Dが最小化された状態でモーダルダイアログを表示した場合，ウィンドウがオフスクリーンに表示されました。

* ACI0104521*webAdmin* 権限がなくてもREST APIの`/rest/$call/method`をPOSTで呼び出すことができました。

* ACI0104483 Windows版のみ。配列型リストボックスの列に設定された関連リストのポップアップメニューがフォームウィンドウの外に表示された場合，選択したメニュー項目の値が正しく代入されませんでした。

* ACI0104543 期限を過ぎたライセンスが存在する場合，ライセンスマネージャーの更新ボタンがクリックできませんでした。

* ACI0104311 設定画面のメソッドページ（テーマ）のリストボックスにスクロールバーが表示されませんでした。

* ACI0104531 コンパイラーメソッドに`//%W-550.10`とコメントを記述しても，「変数を再定義しています」という警告をアプリケーション全体で無視することができませんでした。個別のメソッドにコメントを記述する必要があります。

* ACI0103777 Windows版のみ。View ProスプレッドシートをPDFまたはXPSプリンターで出力しようとした場合，システムエラーが表示され，アプリケーションがクラッシュしました。ACI0103757が修正されたことによる副作用のようです。

* ACI0104501 Windows版のみ。Microsoft Excelから4D ODBC DriverのDNSにアクセスすることができませんでした。

* ACI0104480 ドイツ語版のみ。設定画面のドキュメントURLが正しくありませんでした。ドイツ語のドキュメントは公開されていないので，英語版と同じ *https://developer.4d.com/docs/Preferences/overview* を開くべきです。

* ACI0104523 `&&`または`||`演算子で結合したリレーション属性のクエリ条件が評価されませんでした。v20.1では問題ありません。

* ACI0104520 4D View Proのフォーミュラエディターパネルが正しく動作しませんでした。

* ACI0104516 *shift* キーを押しながらサーバー管理画面（プロセスページ）のスプリッターを縦に移動した場合，内部エラーが返されました。

* ACI0104513 「自動行高」プロパティが有効にされているエンティティセレクション型のリストボックスに表示されているエンティティセレクションを変更した場合，正しい高さで行が表示されませんでした。ウィンドウをリサイズすると，正しい高さで行が再描画されます。

* ACI0104503 *WebAdmin* のポートからリクエストを受信した場合でも*On REST Authentication* データベースメソッドが実行されました。

**注記**: 修正により，ホストではなくコンポーネントの*On REST Authentication* データベースメソッドが実行されるようになりました。

* ACI0104452 クイックレポートのフィールドタイトルを編集中に*escape* キーを入力した場合，エラー`9850`が返されました。

**注記**: リストボックスのセル入力確定前にフォームをアンロードした場合のイベントサイクルに問題がありました。入力エリアでは問題ありません。

* ACI0103597 ドイツ語版またはスペイン語版では`VP REMOVE COLUMNS`が正しく動作しませんでした。

**注記**: SpreadJS 16.2.0で問題が修正されました。

* ACI0103977 自動セッション管理を無効にした場合，RESTアクセスのたびにエラースタックがおおきくなりました。

* ACI0104402 `4D.HTTPRequest`にオブジェクト型のメモリーリークがありました。

* ACI0104478 Intelコンパイルモードのみ。BLOBのインデックス添字にBlob sizeぴったり（つまり`1`バイトオーバー）の位置を渡した場合，範囲チェックが働きませんでした。バッファーオーバーフローにより，アプリケーションがクラッシュする恐れがあります。ARMコンパイラーでは問題ありません。

* ACI0104472 メンテナンス＆セキュリティセンターのアクティビティログの日付フォーマットが正しくありませんでした。`2023-12-21`と出力されるべきところが`12--0021`のように出力されます。

* ACI0104446 Mac版のみ。共有フォルダー内のファイルやフォルダーに対し，`File.rename()`や`Folder.rename()`を使用した場合，「Operation not supported」というPOSIXエラーが返されました。ターミナルで`mv`コマンドを使用すればリネームできるので，アクセス権限の問題ではありません。

**注記**: 4Dは内部的に`renamex_np`をコールしています。修正により，エラー`45`（option not supported by network share）が返された場合，`RENAME_EXLC`を[指定せずに](https://developer.apple.com/documentation/foundation/nsurlvolumesupportsexclusiverenamingkey)リネームを再試行するようになりました。

* ACI0104510 データファイルのサイズ増加に伴い，レコードの保存に要する時間が長くなりました。たとえば`0`GBのデータファイルであれば`10`秒間に約`110,000`件のレコードが作成できるのに対し，`100`GBでは約`42,000`件，`1100`GB（`1.1`TB）では約`6,000`件のレコードしか作成できませんでした。

* ACI0104497 外部プロジェクトに公開オプションの「Webサービス」が有効にされたメソッドが存在する場合，`Compile project`がエラーを返しました。

* ACI0104462 * /RESOURCES/en.lproj* に *syntaxEN.json* が存在する場合，「コンパイル時にコード補完用のシンタックスファイルを生成する」を無効にして再コンパイルしてもファイルが削除されませんでした。

* ACI0104444 `var`シンタックスで複数の変数名と序数引数をまとめて宣言している場合，ローカル変数の再宣言に関するシンタックスチェックの警告メッセージに間違った変数名またはパラメーター名が表示されました。

* ACI0104435 フィールド属性の「必須入力」はプロジェクトモードで廃止されており，ストラクチャエディターのプロパティリストからも項目が削除されていますが，ストラクチャをプロジェクトに変換した場合，`.4DCatalog* ファイルには`mandatory`属性が残され，変換ログにも警告やエラーが出力されませんでした。変換後，当該フィールドを未入力のまま保存するとデータベースエラーが返されます。

**注記**: 修正により，変換ログに下記のエラーが出力されるようになりました。

> "No longer supported 'mandatory' attribute in project found on field '<Field name>' of table '<Table name>'. Please use instead 'Reject NULL value input' (or 'Map NULL values to blank values')"

* ACI0104415 Windows版のみ。複数のモニターが接続されている環境で最大化されたSDIモードのウィンドウを最小化し，タスクバーのアイコンをクリックして復元した場合，元のディスプレイにウィンドウが表示されませんでした。

* ACI0104506 ベベルスタイルのボタンのポップアップメニューをリンクに設定した場合，*.4DForm* ファイルにはフォームイベントの *On Alternate Click* に相当するプロパティが追加されますが，フォームエディターのプロパティリストにはイベント名が表示されませんでした。

* ACI0104499 QUICネットワークレイヤーのみ。ビルド版のクライアントからサーバーに接続しようとした場合，ストラクチャを開くことができない，というエラーが表示されることがありました。特定の変数が正しく初期されていないことが関係しています。

* ACI0104487 *raw* フォーマットのアイテムが`1`個だけ存在する場合，`NetKit.GoogleMailIdList.getMailIds()`が`null`を返しました。*minimal* フォーマットでは問題ありません。

* ACI0104468 ピクチャポップアップメニューのデータソースに`Form`を使用することができませんでした。

* ACI0104433 *.docx* 形式または*.pdf* 形式でWrite Proドキュメントをエクスポートした場合，ソフトハイフンが標準のハイフンに変換されました。

* ACI0104504 メンテナンス＆セキュリティセンター，ツールバー，ライセンス更新などのダイアログのアイコンのタイトルが途切れて表示されました。

* ACI0104490 データクラスに計算属性が存在する場合，フォームエディターのリストボックスビルダーがエラーを返しました。

* ACI0104486 Mac版プロジェクトモードのみ。ツールボックスのヘルプTipsのテキストエリアがダークモードに対応していませんでした。白色の文字が明るい黄色の背景色に表示されます。

* ACI0104485 */$lib/studio* にアクセスしても，*WEBJS/studio* のファイルが返されませんでした。REST APIをコールした後であれば問題ありません。

* ACI0104450 Write Proインタフェースのドロップダウンメニューでフォントを選択した場合，ポップアップの選択項目が変更前のフォント名に戻りました。

* ACI0104445 Mac版のみ。アプリケーションビルドキーの*ServerEmbedsProjectDirectoryFile* を使用した場合，*directory.json* ファイルが非表示ファイルとしてコピーされました。

* ACI0103660 `IMPORT DATA`で読み込みダイアログを開いた場合，テーブルを選択することができませんでした。ファイルメニューからダイアログを起動した場合は問題ありません。

* ACI0104203 プロジェクトモードのみ。ボタンがフォーカスされた状態で`WA OPEN WEB INSPECTOR`を実行した場合，アプリケーションがクラッシュしました。Webエリアがフォーカスされていれば問題ありません。

* ACI0104401 Write Proドキュメントの末尾に段落あるいは行以外のブレークを削除することができませんでした。

* ACI0104386 アプリケーションをビルドした場合，QodlyのWebフォームが表示されませんでした。`PackProject`を`True`に設定し，プロジェクトフォルダーを*.4DZ* 形式に圧縮しなければ問題ありません。

* ACI0104216 `VP IMPORT FROM OBJECT`を実行した場合，メモリーリークが発生しました。*CefProcessHandler* が`15`GBを超えるRAMを占有することがあります。

**注記**: SpreadJS 16.0.xの問題でした。問題は16.2.4で修正されています。

* ACI0104471 `TEXT TO BLOB`に空の文字列を渡した場合，結果が正しくありませんでした。`1`バイトのデータが返されました。
