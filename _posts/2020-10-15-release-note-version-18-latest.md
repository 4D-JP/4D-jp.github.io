---
layout: fix
title: "4D v18 修正リスト"
date: 2020-11-14 08:00:00
categories: 修正リスト
tags: "18.3"
build: 258305
version: 18.3
---

**バージョン**: {{page.version}}  
**ビルド**: {{page.build}}  

* ACI0101390 新規エンティティのリレーション属性が``0``件のエンティティセレクションだった場合，``entitySelection.orderBy()``を実行すると，リレーションで結ばれたデータクラスの全エンティティが返されました。

* ACI0101371 コンパイルされたストラクチャファイル（``.4DC``）で``FORM Convert to dynamic``を実行した場合，オブジェクトメソッドがロードされませんでした。 

* ACI0101244 シリアル通信ポートを開いた状態でデバイスをコンピューターから抜き取ると，アプリケーションがクラッシュしました。

**注記**: 修正により，``RECEIVE PACKET``と同じように``RECEIVE BUFFER``でもエラーが返されるようになりました。

* ACI0101416 Mac版のみ。印刷ダイアログでユーザーがプレビューを有効にした場合，``SET PRINT PREVIEW``でプレビューを無効しても``WP PRINT``でプレビューが表示されました。``Print form``では問題ありません。

* ACI0101363 MIMEの``From``ヘッダー値にカンマが含まれる場合（例：``DOE, John <john.doe@4d.com>``），``MAIL Convert from MIME``で正しいメールオブジェクトに変換できませんでした。アドレス情報が``2``件の送信者（例：``DOE``および``John <john.doe@4d.com>``）に分断されました。

* ACI0100639 フォーカス不可でタブ不可のオブジェクトをJSONフォームあるいはプロジェクトモードに変換した場合，フォーカス可になりました。

**注記**: 同時にルーラーのJSON変換も修正されました。ルーラーもフォーカス可プロパティがエクスポートされるようになり，「上」「左」以外のラベル位置もサポートされるようになりました。

* ACI0101380 4D View Proエリアの「ファイル＞インポート＞CSVファイル」メニューで表示されるインタフェースではCSV以外のテキストデータをインポートすることができませんでした。列または行の区切り文字に``\t``または``\n``のような文字を指定しても無視されました。

**注記**: エクスポートも修正されました。

* ACI0101317 クライアント/サーバー版のみ。ORDA言語でWrite Proドキュメントを保存した後，そのエンティティ属性にアクセスするとエラーが返されました。

* ACI0101218 特定のテーブルに対し，読み込みダイアログを使用してデータをインポートした場合，インポート対象に指定したフィールドがスキップされることがありました。すべてのテーブルで問題が発生するわけではありません。

**注記**: エディターが出力する``.4si``ファイルのフィールド情報にテーブル番号が含まれなかった場合に問題が発生しました。設定ファイルに``table_no``属性を追加することにより，問題を回避することができます。修正により，読み込みダイアログのヘッダークリックで選択されたフィールドのテーブル番号が自動的に挿入されるようになりました。

* ACI0101383 フォームエディターでHTMLヘルプのチャプター番号（アンカー）を更新することができませんでした。

* ACI0101362 クライアント/サーバー版のみ。空のピクチャを含むカレントセレクションに対して``SELECTION TO ARRAY``を実行した場合，エラー``-10533``が返されました。ACI0101266が修正されたことにより副作用のようです。

* ACI0101379 Windows版のみ。デフォルトのファイル名を``*.gif``に設定して``WRITE PICTURE FILE``を実行した場合，保存ダイアログに間違ったファイル拡張子（``.4pct``）が表示されました。

* ACI0101336 macOS Big Surのみ。ディスクイメージ（``.dmg``）からインストールした場合，終了時にアプリケーションがクラッシュしました。アーカイブ（``.zip``）からインストールすれば問題ありません。またストラクチャエディターを表示しなければ問題ありません。

* ACI0101234 ``FORM SCREENSHOT``から返される出力フォームの画像は最終レコードが含まれていませんでした。

* ACI0101217 インポートダイアログでフィールド数が``1``個のテーブルを選択した場合，エラー``215``が返されました。

* ACI0101027 クエリエディターで「である」と「または」を組み合わせた検索条件が正しく読み込まれませんでした。

**注記**: 複数の「または」条件で構成されるクエリは，画面に表示される行数を節約するため，「リストの値いずれかに合致する」フォーミュラに変換されるようになったことが原因でした。修正により，内部的には以前と同じように検索が実行されるようになりました。

* ACI0100734 ``SET ALLOWED METHODS``で許可したメソッドが4D View Proのツールバーに数式として表示されませんでした。

* ACI0101308 ``MAIL convert from MIME``でメールの件名が正しくデコードされないことがありました。折り返されたUTF-8 quoted printableのエスケープ文字がそのまま返される場合がありました。

* ACI0101349 同じフォーミュラが挿入されている4D Write Proドキュメントをインポート・エクスポート・表示・印刷した場合，数式の値が正しくありませんでした。同じフォーミュラは``1``回しか評価されないためです。``ST COMPUTE EXPRESSIONS``で明示的に再計算すれば，問題ありません。

* ACI0101312 ランタイムエクスプローラーの更新間隔を変更しても設定が無視され，常に``1``秒間隔で表示が更新されました。

* ACI0101260 旧式ネットワークレイヤーのみ。4D ServerがWebリクエストを処理している間，4D RemoteのCPUアクティビティが高くなりました。ストラクチャファイルがリードオンリーであれば，問題ありません。Webリクエストを処理するたびに``.4DC``ファイルが更新されているようです。

* ACI0101246 Mac版のみ。別のアプリケーションを最前面に移動してから4Dを最前面に移動した場合，呼び出し元の検索やシンタックスチェックの速度が大幅に低下しました。おおきなアプリケーションの場合，処理が完了するまでにバイナリモードでは``10``秒，プロジェクトモードでは``10``分以上待たされることがありました。

* ACI0101120 ピクチャ型のオブジェクトプロパティを直接``SET PICTURE TO PASTEBOARD``に渡すことができませんでした。

* ACI0101051 Windows版のみ。フォームエディターのテキストエリアに``Alt``キーと数字のコンビネーションでアクセント文字を入力することができませんでした。メソッドエディターでは問題ありません。

* ACI0101041 プロジェクトモードのみ。``folders.json``を外部エディターで編集し，メソッドまたはフォームを下位のフォルダーに移動（カット＆ペースト）した場合，メソッドまたはフォームがトップレベルに複製されました。

* ACI0101010 サーバー管理画面の「プロセス」ページで複数の行を選択うした場合，スクロールバーをクリック＆ドラッグ操作で動かすことができませんでした。

* ACI0101341 クライアント/サーバー版のみ。空のエンティティセレクションに対して``entitySelection.sum()``を使用した場合，メモリーリークが発生しました。

* ACI0101270 エクスプローラーのフォルダーに入れられているフォームまたはプロジェクトメソッドを複製した場合，新しいフォームまたはプロジェクトメソッドがオリジナルと同じフォルダーではなく，エクスプローラーのトップレベルに作成されました。

**注記**: 修正により，エクスプローラーの「ホーム」タブで複数のオブジェクトが選択されていた場合，すべてが複製されるようになりました。v17までは，最初のオブジェクトだけが複製されました。技術的な制約により，バイナリモードでは，選択中のオブジェクトが同一のフォルダーに入れられていなければ，すべてトップレベルに複製されます。プロジェクトモードでは，それぞれのフォルダーに新しいオブジェクトが作成されます。

* ACI0101266 クライアント/サーバー版のみ。保存オプションが「データファイルの外」に設定されているピクチャフィールドに対して``SELECTION TO ARRAY``を実行した場合，エラー``-10533``が返されました。

**注記**: サーバーとクライアントの両方が修正されました。両方のビルドをアップデートする必要があります。

* ACI0100945 ``OB SET``または``OB SET ARRAY``でオブジェクト型フィールドを更新してかた``SAVE RECORD ``で保存した場合，``Modified record``が``True``を返しました。フィールド自体にフィールドを代入すれば，``False``が返されるようになります。

* ACI0101280 4D ViewスプレッドシートをView Proに変換した場合，埋め込まれたフォーミュラの大部分が失われることがありました。

**注記**: View Proの限界を超える長さのフォーミュラが出力されることがありました。たとえば，データ型を文字列で統一するため，各パラメーターを関数でキャストしているようなフォーミュラを変換した場合，数式がさらに長くなりました。修正により，日付リテラルは文字列型リテラル，``String``関数はシンプルな関数名（``TEXT``）に変換されるようになりました。View Proの標準関数は，内部的にバリアント側を使用しているため，日付を文字列で渡すことができます。

* ACI0101315 ``entitySelection.query()``および``collection.query()``で``IN``比較演算子を使用した場合，条件に使用したコレクションがメモリーリークすることがありました。

* ACI0101305 リストボックスの「自動行の高さ」が有効にされている場合，``OBJECT GET SCROLL POSITION``から返される行番号が``0``から始まりました。通常のリストボックスであれば，行番号が``1``から始まります。

**注記**: 問題は修正されましたが，プロパティによってコマンドの振る舞いが違うことに留意してください。「自動行の高さ」が有効にされていない場合，階層リストやリストフォームと同じように，コマンドは完全に表示されている最初の行番号を返します。リストボックスの「自動行の高さ」が有効にされている場合，コマンドは部分的であっても表示されている最初の行番号を返します。

* ACI0101298 背景色が設定されているテキスト入力エリアに対して``OBJECT SET RGB COLORS``を使用した場合，フォーカスアウトのタイミングで``On Data change``イベントが発生しました。背景色が「透過」に設定されているオブジェクトは問題ありません。

* ACI0101061 プロジェクトモードのみ。新規作成したリストボックスには「行の移動可」プロパティがありませんでした。バイナリモードから変換されたリストボックスは問題ありません。プロパティが設定されていない場合，行のドラッグ＆ドロップができません。

* ACI0100977 プロジェクトモードのみ。図形オブジェクトの「角の丸み」プロパティが``0``以外の値に設定されていない場合，``OBJECT SET CORNER RADIUS``が使用できませんでした。

* ACI0101067 ``MAIL Convert from MIME``で変換したメールオブジェクトは，送信日が正しく返されないことがありました。タイムゾーンが正しく計算されていないためです。たとえばMIMEのヘッダー値が``Mon, 3 Aug 2020 09:27:52 +0200``だった場合，``2020-08-03T09:27:52.000Z``のような日付に変換されました。

* ACI0101212 ``MAIL Convert from MIME``でメールオブジェクトを作成した場合，エンコードに問題があるために画像が表示されないことがありました。

* ACI0101209 エンティティセレクション型のリストボックスをサブフォーム内で使用した場合，「カレントの項目の位置」や「選択された項目」がデバッガに表示されませんでした。「カレントの項目」だけが表示されました。

* ACI0101135 プロジェクトモードのみ。``LISTBOX SET PROPERTY``と``lk named selection``の組み合わせでリストボックスの命名セレクションを設定することができませんでした。

* ACI0101114 Mac版のみ。ポップアップ/ドロップダウンメニューに大文字/小文字の区別またはアクセント記号だけが違っている値が表示されている場合，カレント項目ではない行にチェックマークが表示されました。

* ACI0099364 Mac 64ビット版のみ。プラグインSDKの``PA_GetCarbonPageFormat``および``PA_GetCarbonPrintSettings``が``null``を返しました。

**注記**: 修正により，``PA_GetCarbonPrintSettings``および``PA_GetCarbonPageFormat``は4Dが内部的に使用しているプリント設定のコピーを返すようになりました。32ビット版（carbon）とは違い，コピーなので，変更は本来のプリント設定に反映されません。オブジェクトは4Dが保有しているため，開放はしないでください。同じように``PA_GetWindowsPRINTDLG``は``PRINTDLGW``のコピーを返すようになりました。

* ACI0101294 ``VP Convert to picture``はシート番号を``0``ではなく``1``からカウントしました。

* ACI0101254 バイナリモードのみ。オブジェクトメソッドが設定されているオブジェクトを含むフォームを削除してごみ箱に空にした場合，MSCのアプリケーション検査を実行すると，どこにも使用されていない``CC4D``リソース（オーファンメソッド）が検出されました。

* ACI0100870 ``ENCRYPT BLOB``の第３パラメーターに未定義の変数を渡した場合，アプリケーションがクラッシュしました。

* ACI0100004 ノルウェー語とフランス語のスペルチェック辞書に同一のID番号が振られました。

**注記**: Mac版のシステムスペルチェックだけが修正され，番号ではなく``fr-FR``や``en-US``のような識別子が使用されるようになりました。Hunspell版のスペルチェックは，ライブラリが発行するIDをそのまま使用しています。

* ACI0100922 アプリケーションが最前面ではなくなった初回のタイミングでは``On Application background move``システムイベントが発生しませんでした。
